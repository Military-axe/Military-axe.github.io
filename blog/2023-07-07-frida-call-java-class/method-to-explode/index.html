<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  

  
  <title>Frida call java class/method to explode</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="/css/fork-awesome.min.css">
  

  
  
    <link href="https://military-axe.github.io/myfavicon.jpg" rel="icon">
  

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="">
  <meta name="author" content="Mi1itray.axe">

  
  <meta name="generator" content="Hugo 0.113.0">

  
  

  
  



</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="https://military-axe.github.io/">mi1itray.axe</a></h1>
    <h2>mi1itray.axe@gmail.com</h2>
</hgroup></header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
        <option value="https://military-axe.github.io/">» Blog</option>
      
        <option value="https://military-axe.github.io/categories">» Categories</option>
      
        <option value="https://military-axe.github.io/tags">» Tags</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="https://military-axe.github.io/" title="Blog">Blog</a></li>
    
  
    
      <li><a href="https://military-axe.github.io/categories" title="Categories"  target="_blank"  rel="noopener noreferrer">Categories</a></li>
    
  
    
      <li><a href="https://military-axe.github.io/tags" title="Tags"  target="_blank"  rel="noopener noreferrer">Tags</a></li>
    
  
</ul>

<ul class="subscription">
  
    
        <a href="https://military-axe.github.io/index.xml" target="_blank" type="application/rss+xml" title="RSS" rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
    
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank" rel="noopener noreferrer">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:https://military-axe.github.io/" />
    </fieldset>
  </form>

</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">Jul 7, 2023
     - 7 minute read 
    

    
    
      - <a class="label" href="https://military-axe.github.io/categories/reverse/">Reverse </a><a class="label" href="https://military-axe.github.io/categories/mobile/">Mobile </a>
    
  </p>
  <h1 class="entry-title">
     Frida call java class/method to explode 
  </h1>
</header>


        <div class="entry-content">
          
          
          
            <nav id="TableOfContents">
  <ul>
    <li><a href="#背景知识">背景知识</a>
      <ul>
        <li><a href="#frida捕获异常">frida捕获异常</a></li>
        <li><a href="#java类中静态值在爆破中需要修改">java类中静态值在爆破中需要修改</a></li>
        <li><a href="#frida调用java中静态方法与动态方法">frida调用java中静态方法与动态方法</a></li>
      </ul>
    </li>
    <li><a href="#easy-qahe17">Easy-QAHE17</a></li>
    <li><a href="#easyjava">EasyJava</a></li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
          
          <p>利用Frida去调用java代码中的类，然后爆破。算是一种主动的方法。主要是之前有一道apk题目是爆破的思路，但是我不会写java代码，想起来很难受，冲浪的时候看到
<a href="https://eternalsakura13.com/" target="_blank" rel="noopener">Sakura</a>的blog有感，就再去试试，并记录在此。然后发现这题原来是adword原题，（其实题目挺简单，只是当时摆），气死✌了。</p>
<p>主要是记录Frida主动调用apk中Java中的代码。主动调用可以用于爆破，模拟程序部分执行。</p>
<p>需要注意的知识点是在java代码中的static类型数据在爆破过程中需要每次都对这种类型值重新设置。因为static类型在所有实例中都是统一，修改一个实例就会修改所有实例，需要用<code>变量.属性.value = ...</code>的写法重新设置值。</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#ff7b72">var</span> bvar <span style="color:#ff7b72;font-weight:bold">=</span> b.$new(IntClass.$new(<span style="color:#a5d6ff">2</span>));
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">for</span> (...) {
</span></span><span style="display:flex;"><span>    bvar._static_val.value <span style="color:#ff7b72;font-weight:bold">=</span> ...;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="背景知识">背景知识</h1>
<h2 id="frida捕获异常">frida捕获异常</h2>
<p>有的时候frida卡住，或者直接终止，没有异常显示，需要去捕获异常，调试脚本真的很有用！！其实就是调用js的异常捕获</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#ff7b72">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic">// 逻辑
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>} <span style="color:#ff7b72">catch</span>(e) {
</span></span><span style="display:flex;"><span>    console.log(e);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="java类中静态值在爆破中需要修改">java类中静态值在爆破中需要修改</h2>
<p>在java类中，一个属性如果是<code>static</code>的，不是说这个值不能改，而是说这个属性在程序中是唯一的，无论几个实例，只要改了其中一个实例中static的值，其他实例对应的值也会被改变。</p>
<p>在爆破过程中，如果需要爆破过程中不停new一个新的类实例，记得看看其中有没有static类型的变量。比如下面的这个例子</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff7b72">public</span> <span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">b</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">public</span> <span style="color:#ff7b72">static</span> ArrayList<span style="color:#ff7b72;font-weight:bold">&lt;</span>Integer<span style="color:#ff7b72;font-weight:bold">&gt;</span> a <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">new</span> ArrayList<span style="color:#ff7b72;font-weight:bold">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">static</span> String b <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">static</span> Integer d <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    Integer<span style="color:#ff7b72;font-weight:bold">[]</span> c <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72;font-weight:bold">{</span><span style="color:#a5d6ff">8</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">25</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">17</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">23</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">7</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">22</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">1</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">16</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">6</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">9</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">21</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">15</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">5</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">10</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">18</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">2</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">24</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">4</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">11</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">3</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">14</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">19</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">12</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">20</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">13</span><span style="color:#ff7b72;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">public</span> <span style="color:#d2a8ff;font-weight:bold">b</span><span style="color:#ff7b72;font-weight:bold">(</span>Integer num<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">for</span> <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">int</span> intValue <span style="color:#ff7b72;font-weight:bold">=</span> num<span style="color:#ff7b72;font-weight:bold">.</span>intValue<span style="color:#ff7b72;font-weight:bold">();</span> intValue <span style="color:#ff7b72;font-weight:bold">&lt;</span> <span style="color:#ff7b72">this</span><span style="color:#ff7b72;font-weight:bold">.</span>c<span style="color:#ff7b72;font-weight:bold">.</span>length<span style="color:#ff7b72;font-weight:bold">;</span> intValue<span style="color:#ff7b72;font-weight:bold">++)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            a<span style="color:#ff7b72;font-weight:bold">.</span>add<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">this</span><span style="color:#ff7b72;font-weight:bold">.</span>c<span style="color:#ff7b72;font-weight:bold">[</span>intValue<span style="color:#ff7b72;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">for</span> <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">int</span> i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">;</span> i <span style="color:#ff7b72;font-weight:bold">&lt;</span> num<span style="color:#ff7b72;font-weight:bold">.</span>intValue<span style="color:#ff7b72;font-weight:bold">();</span> i<span style="color:#ff7b72;font-weight:bold">++)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            a<span style="color:#ff7b72;font-weight:bold">.</span>add<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">this</span><span style="color:#ff7b72;font-weight:bold">.</span>c<span style="color:#ff7b72;font-weight:bold">[</span>i<span style="color:#ff7b72;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>每次new一个b类，比如<code>b bVar = new b(2)</code>.如果要不停调用这个类，并且使用其中的方法，要注意其中的<code>static</code>变量会不会变。如果会变，那么在爆破过程中，需要new完实例后，修改static变量的值。</p>
<h2 id="frida调用java中静态方法与动态方法">frida调用java中静态方法与动态方法</h2>
<p>如果调用静态方法，可以直接调用，比如java代码如下</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff7b72">public</span> <span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">Verifier</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">private</span> <span style="color:#d2a8ff;font-weight:bold">Verifier</span><span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">public</span> <span style="color:#ff7b72">static</span> <span style="color:#ff7b72">boolean</span> <span style="color:#d2a8ff;font-weight:bold">verifyPassword</span><span style="color:#ff7b72;font-weight:bold">(</span>Context context<span style="color:#ff7b72;font-weight:bold">,</span> String input<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#ff7b72;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>那么如果调用verifyPassword可以直接在frida中调用</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span> <span style="color:#ff7b72">var</span> verify <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;org.teamsik.ahe17.qualification.Verifier&#34;</span>);
</span></span><span style="display:flex;"><span>verify.verifyPassword(a, b);
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果是动态方法，有两种方法可以调用动态方法</p>
<p>第一种是，使用内存中已存在实例的方法，需要用到<code>java.choose(...)</code>，这个是在内存中寻找对象</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">//从内存中（堆）直接搜索已存在的对象
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>Java.choose(<span style="color:#a5d6ff">&#39;xxx.xxx.xxx&#39;</span>, <span style="color:#8b949e;font-style:italic">//这里写类名 
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>{	<span style="color:#8b949e;font-style:italic">//onMatch 匹配到对象执行的回调函数
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>	onMatch<span style="color:#ff7b72;font-weight:bold">:</span> <span style="color:#ff7b72">function</span> (instance) {
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#8b949e;font-style:italic">//堆中搜索完成后执行的回调函数
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>    onComplete<span style="color:#ff7b72;font-weight:bold">:</span> <span style="color:#ff7b72">function</span> () {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></td></tr></table>
</div>
</div><p>第二种是，我们new一个新的实例，然后调用实例中的方法</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span> <span style="color:#8b949e;font-style:italic">//获取类的引用
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span><span style="color:#ff7b72">var</span> cls <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#39;这里写类名&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">//调用构造函数 创建新对象  这里注意参数
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span><span style="color:#ff7b72">var</span> obj <span style="color:#ff7b72;font-weight:bold">=</span> cls.$new();
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="easy-qahe17">Easy-QAHE17</h1>
<p>题目地址：
<a href="https://github.com/Military-axe/ctf/tree/master/2023/Easy-QAHE17" target="_blank" rel="noopener">ctf/2023/Easy-QAHE17 at master · Military-axe/ctf · GitHub</a></p>
<p>首先是看Sakura中提到的题目，也就是吾爱破解的一道题目。核心代码如下</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff7b72">public</span> <span style="color:#ff7b72">void</span> <span style="color:#d2a8ff;font-weight:bold">verifyPasswordClick</span><span style="color:#ff7b72;font-weight:bold">(</span>View view<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        String password <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">this</span><span style="color:#ff7b72;font-weight:bold">.</span>txPassword<span style="color:#ff7b72;font-weight:bold">.</span>getText<span style="color:#ff7b72;font-weight:bold">().</span>toString<span style="color:#ff7b72;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">(!</span>Verifier<span style="color:#ff7b72;font-weight:bold">.</span>verifyPassword<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">this</span><span style="color:#ff7b72;font-weight:bold">,</span> password<span style="color:#ff7b72;font-weight:bold">))</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            Toast<span style="color:#ff7b72;font-weight:bold">.</span>makeText<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">this</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">int</span><span style="color:#ff7b72;font-weight:bold">)</span> org<span style="color:#ff7b72;font-weight:bold">.</span>teamsik<span style="color:#ff7b72;font-weight:bold">.</span>ahe17<span style="color:#ff7b72;font-weight:bold">.</span>qualification<span style="color:#ff7b72;font-weight:bold">.</span>easy<span style="color:#ff7b72;font-weight:bold">.</span>R<span style="color:#ff7b72;font-weight:bold">.</span>string<span style="color:#ff7b72;font-weight:bold">.</span>dialog_failure<span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">1</span><span style="color:#ff7b72;font-weight:bold">).</span>show<span style="color:#ff7b72;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span> <span style="color:#ff7b72">else</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            showSuccessDialog<span style="color:#ff7b72;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">public</span> <span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">Verifier</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">private</span> <span style="color:#d2a8ff;font-weight:bold">Verifier</span><span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">public</span> <span style="color:#ff7b72">static</span> <span style="color:#ff7b72">boolean</span> <span style="color:#d2a8ff;font-weight:bold">verifyPassword</span><span style="color:#ff7b72;font-weight:bold">(</span>Context context<span style="color:#ff7b72;font-weight:bold">,</span> String input<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">(</span>input<span style="color:#ff7b72;font-weight:bold">.</span>length<span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">!=</span> <span style="color:#a5d6ff">4</span><span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">return</span> <span style="color:#79c0ff">false</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">byte</span><span style="color:#ff7b72;font-weight:bold">[]</span> v <span style="color:#ff7b72;font-weight:bold">=</span> encodePassword<span style="color:#ff7b72;font-weight:bold">(</span>input<span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">byte</span><span style="color:#ff7b72;font-weight:bold">[]</span> p <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;09042ec2c2c08c4cbece042681caf1d13984f24a&#34;</span><span style="color:#ff7b72;font-weight:bold">.</span>getBytes<span style="color:#ff7b72;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">(</span>v<span style="color:#ff7b72;font-weight:bold">.</span>length <span style="color:#ff7b72;font-weight:bold">==</span> p<span style="color:#ff7b72;font-weight:bold">.</span>length<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">for</span> <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">int</span> i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">;</span> i <span style="color:#ff7b72;font-weight:bold">&lt;</span> v<span style="color:#ff7b72;font-weight:bold">.</span>length<span style="color:#ff7b72;font-weight:bold">;</span> i<span style="color:#ff7b72;font-weight:bold">++)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">(</span>v<span style="color:#ff7b72;font-weight:bold">[</span>i<span style="color:#ff7b72;font-weight:bold">]</span> <span style="color:#ff7b72;font-weight:bold">!=</span> p<span style="color:#ff7b72;font-weight:bold">[</span>i<span style="color:#ff7b72;font-weight:bold">])</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff7b72">return</span> <span style="color:#79c0ff">false</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">return</span> <span style="color:#79c0ff">true</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> <span style="color:#79c0ff">false</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>输入长度为4，通过分析后面知道输入是数字。所以范围是1000-9999.所以是可以爆破的，但是爆破是要用到<code>encodePassword</code>方法，自己写一个当然也可以，但是很麻烦，关键是我不会写java代码。这里就可以直接frida调用<code>encodePassword</code>函数.</p>
<blockquote>
<p>注意这里encodePassword是静态方法，所以可以直接调用</p>
</blockquote>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#ff7b72">function</span> main() {
</span></span><span style="display:flex;"><span>    Java.perform(<span style="color:#ff7b72">function</span> x() {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#a5d6ff">&#34;In Java perform&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> verify <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;org.teamsik.ahe17.qualification.Verifier&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> stringClass <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;java.lang.String&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> p <span style="color:#ff7b72;font-weight:bold">=</span> stringClass.$new(<span style="color:#a5d6ff">&#34;09042ec2c2c08c4cbece042681caf1d13984f24a&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">for</span> (<span style="color:#ff7b72">var</span> i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">999</span>; i <span style="color:#ff7b72;font-weight:bold">&lt;</span> <span style="color:#a5d6ff">10000</span>; i<span style="color:#ff7b72;font-weight:bold">++</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">var</span> v <span style="color:#ff7b72;font-weight:bold">=</span> stringClass.$new(String(i))
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">var</span> vSign <span style="color:#ff7b72;font-weight:bold">=</span> verify.encodePassword(v)
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">if</span> (parseInt(p) <span style="color:#ff7b72;font-weight:bold">==</span> parseInt(stringClass.$new(vSign))) {
</span></span><span style="display:flex;"><span>                console.log(<span style="color:#a5d6ff">&#34;yes: &#34;</span> <span style="color:#ff7b72;font-weight:bold">+</span> v)
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">break</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            console.log(<span style="color:#a5d6ff">&#34;not :&#34;</span> <span style="color:#ff7b72;font-weight:bold">+</span> v)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>setImmediate(main)
</span></span></code></pre></td></tr></table>
</div>
</div><p>结果</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>not :9078
</span></span><span style="display:flex;"><span>not :9079
</span></span><span style="display:flex;"><span>not :9080
</span></span><span style="display:flex;"><span>not :9081
</span></span><span style="display:flex;"><span>not :9082
</span></span><span style="display:flex;"><span>yes: 9083
</span></span></code></pre></td></tr></table>
</div>
</div><p>需要注意的是，要调用<code>parseInt</code>解析内存中的内存再对比，因为string类型是java的string类型，对js代码来说是一段内存。</p>
<h1 id="easyjava">EasyJava</h1>
<p>题目地址：
<a href="https://github.com/Military-axe/ctf/tree/master/2023/easyjava" target="_blank" rel="noopener">ctf/2023/easyjava at master · Military-axe/ctf · GitHub</a></p>
<p>这题的正常解法可以查到：
<a href="https://www.cnblogs.com/cainiao-chuanqi/p/13565030.html" target="_blank" rel="noopener">攻防世界新手练习题_MOBILE(移动)</a></p>
<p>这题是纯java题，逻辑很清晰，对输入的每一个字符单个检查，加密并对比。所以可以很简单的想到爆破的思路</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff7b72">public</span> <span style="color:#ff7b72">static</span> Boolean <span style="color:#d2a8ff;font-weight:bold">b</span><span style="color:#ff7b72;font-weight:bold">(</span>String str<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">(</span>str<span style="color:#ff7b72;font-weight:bold">.</span>startsWith<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">&#34;flag{&#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">&amp;&amp;</span> str<span style="color:#ff7b72;font-weight:bold">.</span>endsWith<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">&#34;}&#34;</span><span style="color:#ff7b72;font-weight:bold">))</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        String substring <span style="color:#ff7b72;font-weight:bold">=</span> str<span style="color:#ff7b72;font-weight:bold">.</span>substring<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">5</span><span style="color:#ff7b72;font-weight:bold">,</span> str<span style="color:#ff7b72;font-weight:bold">.</span>length<span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">-</span> <span style="color:#a5d6ff">1</span><span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        b bVar <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">new</span> b<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">2</span><span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        a aVar <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">new</span> a<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">3</span><span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        StringBuilder sb <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">new</span> StringBuilder<span style="color:#ff7b72;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">int</span> i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">for</span> <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">int</span> i2 <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">;</span> i2 <span style="color:#ff7b72;font-weight:bold">&lt;</span> substring<span style="color:#ff7b72;font-weight:bold">.</span>length<span style="color:#ff7b72;font-weight:bold">();</span> i2<span style="color:#ff7b72;font-weight:bold">++)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            sb<span style="color:#ff7b72;font-weight:bold">.</span>append<span style="color:#ff7b72;font-weight:bold">(</span>a<span style="color:#ff7b72;font-weight:bold">(</span>substring<span style="color:#ff7b72;font-weight:bold">.</span>charAt<span style="color:#ff7b72;font-weight:bold">(</span>i2<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#a5d6ff">&#34;&#34;</span><span style="color:#ff7b72;font-weight:bold">,</span> bVar<span style="color:#ff7b72;font-weight:bold">,</span> aVar<span style="color:#ff7b72;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>            Integer valueOf <span style="color:#ff7b72;font-weight:bold">=</span> Integer<span style="color:#ff7b72;font-weight:bold">.</span>valueOf<span style="color:#ff7b72;font-weight:bold">(</span>bVar<span style="color:#ff7b72;font-weight:bold">.</span>b<span style="color:#ff7b72;font-weight:bold">().</span>intValue<span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">/</span> <span style="color:#a5d6ff">25</span><span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">(</span>valueOf<span style="color:#ff7b72;font-weight:bold">.</span>intValue<span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">&gt;</span> i <span style="color:#ff7b72;font-weight:bold">&amp;&amp;</span> valueOf<span style="color:#ff7b72;font-weight:bold">.</span>intValue<span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">&gt;=</span> <span style="color:#a5d6ff">1</span><span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                i<span style="color:#ff7b72;font-weight:bold">++;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> Boolean<span style="color:#ff7b72;font-weight:bold">.</span>valueOf<span style="color:#ff7b72;font-weight:bold">(</span>sb<span style="color:#ff7b72;font-weight:bold">.</span>toString<span style="color:#ff7b72;font-weight:bold">().</span>equals<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">&#34;wigwrkaugala&#34;</span><span style="color:#ff7b72;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> <span style="color:#79c0ff">false</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>所以可以单个字符爆破，但是要注意到，<code>com.a.easyjava.b</code>和<code>com.a.easyjava.a</code>两个类中都存在static属性的变量，下面是b类的</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">45
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff7b72">public</span> <span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">b</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">public</span> <span style="color:#ff7b72">static</span> ArrayList<span style="color:#ff7b72;font-weight:bold">&lt;</span>Integer<span style="color:#ff7b72;font-weight:bold">&gt;</span> a <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">new</span> ArrayList<span style="color:#ff7b72;font-weight:bold">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">static</span> String b <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">static</span> Integer d <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    Integer<span style="color:#ff7b72;font-weight:bold">[]</span> c <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72;font-weight:bold">{</span><span style="color:#a5d6ff">8</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">25</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">17</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">23</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">7</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">22</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">1</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">16</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">6</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">9</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">21</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">15</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">5</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">10</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">18</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">2</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">24</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">4</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">11</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">3</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">14</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">19</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">12</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">20</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">13</span><span style="color:#ff7b72;font-weight:bold">};</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">public</span> <span style="color:#d2a8ff;font-weight:bold">b</span><span style="color:#ff7b72;font-weight:bold">(</span>Integer num<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">for</span> <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">int</span> intValue <span style="color:#ff7b72;font-weight:bold">=</span> num<span style="color:#ff7b72;font-weight:bold">.</span>intValue<span style="color:#ff7b72;font-weight:bold">();</span> intValue <span style="color:#ff7b72;font-weight:bold">&lt;</span> <span style="color:#ff7b72">this</span><span style="color:#ff7b72;font-weight:bold">.</span>c<span style="color:#ff7b72;font-weight:bold">.</span>length<span style="color:#ff7b72;font-weight:bold">;</span> intValue<span style="color:#ff7b72;font-weight:bold">++)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            a<span style="color:#ff7b72;font-weight:bold">.</span>add<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">this</span><span style="color:#ff7b72;font-weight:bold">.</span>c<span style="color:#ff7b72;font-weight:bold">[</span>intValue<span style="color:#ff7b72;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">for</span> <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">int</span> i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">;</span> i <span style="color:#ff7b72;font-weight:bold">&lt;</span> num<span style="color:#ff7b72;font-weight:bold">.</span>intValue<span style="color:#ff7b72;font-weight:bold">();</span> i<span style="color:#ff7b72;font-weight:bold">++)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            a<span style="color:#ff7b72;font-weight:bold">.</span>add<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">this</span><span style="color:#ff7b72;font-weight:bold">.</span>c<span style="color:#ff7b72;font-weight:bold">[</span>i<span style="color:#ff7b72;font-weight:bold">]);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">public</span> <span style="color:#ff7b72">static</span> <span style="color:#ff7b72">void</span> <span style="color:#d2a8ff;font-weight:bold">a</span><span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">int</span> intValue <span style="color:#ff7b72;font-weight:bold">=</span> a<span style="color:#ff7b72;font-weight:bold">.</span>get<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">).</span>intValue<span style="color:#ff7b72;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        a<span style="color:#ff7b72;font-weight:bold">.</span>remove<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        a<span style="color:#ff7b72;font-weight:bold">.</span>add<span style="color:#ff7b72;font-weight:bold">(</span>Integer<span style="color:#ff7b72;font-weight:bold">.</span>valueOf<span style="color:#ff7b72;font-weight:bold">(</span>intValue<span style="color:#ff7b72;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>        b <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#a5d6ff">&#34;&#34;</span> <span style="color:#ff7b72;font-weight:bold">+</span> b<span style="color:#ff7b72;font-weight:bold">.</span>charAt<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        b <span style="color:#ff7b72;font-weight:bold">=</span> b<span style="color:#ff7b72;font-weight:bold">.</span>substring<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">1</span><span style="color:#ff7b72;font-weight:bold">,</span> <span style="color:#a5d6ff">27</span><span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        Integer num <span style="color:#ff7b72;font-weight:bold">=</span> d<span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        d <span style="color:#ff7b72;font-weight:bold">=</span> Integer<span style="color:#ff7b72;font-weight:bold">.</span>valueOf<span style="color:#ff7b72;font-weight:bold">(</span>d<span style="color:#ff7b72;font-weight:bold">.</span>intValue<span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#a5d6ff">1</span><span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">public</span> Integer <span style="color:#d2a8ff;font-weight:bold">a</span><span style="color:#ff7b72;font-weight:bold">(</span>String str<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">int</span> i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">(</span>b<span style="color:#ff7b72;font-weight:bold">.</span>contains<span style="color:#ff7b72;font-weight:bold">(</span>str<span style="color:#ff7b72;font-weight:bold">.</span>toLowerCase<span style="color:#ff7b72;font-weight:bold">()))</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            Integer valueOf <span style="color:#ff7b72;font-weight:bold">=</span> Integer<span style="color:#ff7b72;font-weight:bold">.</span>valueOf<span style="color:#ff7b72;font-weight:bold">(</span>b<span style="color:#ff7b72;font-weight:bold">.</span>indexOf<span style="color:#ff7b72;font-weight:bold">(</span>str<span style="color:#ff7b72;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">for</span> <span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#ff7b72">int</span> i2 <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span><span style="color:#ff7b72;font-weight:bold">;</span> i2 <span style="color:#ff7b72;font-weight:bold">&lt;</span> a<span style="color:#ff7b72;font-weight:bold">.</span>size<span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">-</span> <span style="color:#a5d6ff">1</span><span style="color:#ff7b72;font-weight:bold">;</span> i2<span style="color:#ff7b72;font-weight:bold">++)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">if</span> <span style="color:#ff7b72;font-weight:bold">(</span>a<span style="color:#ff7b72;font-weight:bold">.</span>get<span style="color:#ff7b72;font-weight:bold">(</span>i2<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">==</span> valueOf<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    i <span style="color:#ff7b72;font-weight:bold">=</span> Integer<span style="color:#ff7b72;font-weight:bold">.</span>valueOf<span style="color:#ff7b72;font-weight:bold">(</span>i2<span style="color:#ff7b72;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span> <span style="color:#ff7b72">else</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            i <span style="color:#ff7b72;font-weight:bold">=</span> str<span style="color:#ff7b72;font-weight:bold">.</span>contains<span style="color:#ff7b72;font-weight:bold">(</span><span style="color:#a5d6ff">&#34; &#34;</span><span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">?</span> <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">10</span> <span style="color:#ff7b72;font-weight:bold">:</span> <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1</span><span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        a<span style="color:#ff7b72;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> i<span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">public</span> Integer <span style="color:#d2a8ff;font-weight:bold">b</span><span style="color:#ff7b72;font-weight:bold">()</span> <span style="color:#ff7b72;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> d<span style="color:#ff7b72;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>b类中的a，b，d变量都是static类型的同时，这三个变量都会被下面的方法所改变。所以如果要爆破，需要重新修改实例中的属性值。如果不重新修改属性的值，我们通过观察b类中的b变量可以看到会有什么问题。</p>
<blockquote>
<p>这个脚本是爆破第一个字符在加密后所有的可能性。爆破范围通过分析b类可以缩小到<code>a-z</code>，然后模仿加密过程，加密一个字符看看结果。中间每循环一次会重新申请一个<code>b</code>和<code>a</code>类的实例，想通过申请新的实例来避免类中变量的修改.</p>
</blockquote>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#ff7b72">function</span> main() {
</span></span><span style="display:flex;"><span>    Java.perform(<span style="color:#ff7b72">function</span> x() {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#a5d6ff">&#39;[+] script load&#39;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> b <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;com.a.easyjava.b&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> a <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;com.a.easyjava.a&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> StringClass <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;java.lang.String&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> IntClass <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;java.lang.Integer&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> MainActivity <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;com.a.easyjava.MainActivity&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">try</span> { <span style="color:#8b949e;font-style:italic">// try catch 用来查看报错的，可以去掉
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>            <span style="color:#ff7b72">for</span> (<span style="color:#ff7b72">var</span> i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">97</span>; i <span style="color:#ff7b72;font-weight:bold">&lt;</span> <span style="color:#a5d6ff">123</span>; i<span style="color:#ff7b72;font-weight:bold">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">var</span> bvar <span style="color:#ff7b72;font-weight:bold">=</span> b.$new(IntClass.$new(<span style="color:#a5d6ff">2</span>));
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">var</span> avar <span style="color:#ff7b72;font-weight:bold">=</span> a.$new(IntClass.$new(<span style="color:#a5d6ff">3</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">var</span> s <span style="color:#ff7b72;font-weight:bold">=</span> String.fromCharCode(i);
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">var</span> c <span style="color:#ff7b72;font-weight:bold">=</span> MainActivity.a(s, bvar, avar);
</span></span><span style="display:flex;"><span>                console.log(<span style="color:#a5d6ff">`enc(</span><span style="color:#a5d6ff">${</span>s<span style="color:#a5d6ff">}</span><span style="color:#a5d6ff">) =&gt; </span><span style="color:#a5d6ff">${</span>c<span style="color:#a5d6ff">}</span><span style="color:#a5d6ff">, b.a =&gt; </span><span style="color:#a5d6ff">${</span>b._b.value<span style="color:#a5d6ff">}</span><span style="color:#a5d6ff">`</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#ff7b72">catch</span> (e) {
</span></span><span style="display:flex;"><span>            console.log(e);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#a5d6ff">&#39;[+] script end&#39;</span>);
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>setImmediate(main)
</span></span></code></pre></td></tr></table>
</div>
</div><p>结果如下</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"># python3 loader.py</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">[</span>+<span style="color:#ff7b72;font-weight:bold">]</span> script load
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>a<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; bcdefghijklmnopqrstuvwxyza
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>b<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; cdefghijklmnopqrstuvwxyzab
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>c<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; defghijklmnopqrstuvwxyzabc
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>d<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; efghijklmnopqrstuvwxyzabcd
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>e<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; fghijklmnopqrstuvwxyzabcde
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>f<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; ghijklmnopqrstuvwxyzabcdef
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>g<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; hijklmnopqrstuvwxyzabcdefg
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>h<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; ijklmnopqrstuvwxyzabcdefgh
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>i<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; jklmnopqrstuvwxyzabcdefghi
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>j<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; klmnopqrstuvwxyzabcdefghij
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>k<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; lmnopqrstuvwxyzabcdefghijk
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>l<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; mnopqrstuvwxyzabcdefghijkl
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>m<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; nopqrstuvwxyzabcdefghijklm
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>n<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; opqrstuvwxyzabcdefghijklmn
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>o<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; pqrstuvwxyzabcdefghijklmno
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>p<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; qrstuvwxyzabcdefghijklmnop
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>q<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; rstuvwxyzabcdefghijklmnopq
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>r<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; stuvwxyzabcdefghijklmnopqr
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>s<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; tuvwxyzabcdefghijklmnopqrs
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>t<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; uvwxyzabcdefghijklmnopqrst
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>u<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; vwxyzabcdefghijklmnopqrstu
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>v<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; wxyzabcdefghijklmnopqrstuv
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>w<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; xyzabcdefghijklmnopqrstuvw
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>x<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; yzabcdefghijklmnopqrstuvwx
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>y<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; zabcdefghijklmnopqrstuvwxy
</span></span><span style="display:flex;"><span>enc<span style="color:#ff7b72;font-weight:bold">(</span>z<span style="color:#ff7b72;font-weight:bold">)</span> <span style="color:#ff7b72;font-weight:bold">=</span>&gt; a, b.b <span style="color:#ff7b72;font-weight:bold">=</span>&gt; abcdefghijklmnopqrstuvwxyz
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">[</span>+<span style="color:#ff7b72;font-weight:bold">]</span> script end
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到实际上，虽然每次new了一个新的实例，但是实例中的static变量是变了的，这导致了之前的爆破会影响到下一次爆破，同时也可以看到加密结果全部都是<code>a</code>。所以如果要爆破，就得想办法让每次爆破，新的实例中的值不变。</p>
<p>需要使用<code>bvar._b.value = StringClass.$new(&quot;abcdefghijklmnopqrstuvwxyz&quot;);</code>这样的语法对static类型的变量重新设值。</p>
<blockquote>
<p>需要注意的是有些变量在jadx/jeb中看到的名字可能会被重载，需要加一个下划线比如b -&gt; _b。可以通过console打印看看是不是unknow，也可以直接用jadx右键复制frida片段，查看此变量frida需不需要加一个下划线</p>
</blockquote>
<p>解题脚本的思路就很简单，单个字符来爆破，每次重新生成类的实例，并将类中的值置为初始状态（通过调用类<code>$init</code>方法）。</p>
<p>exp</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">51
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#ff7b72">function</span> main() {
</span></span><span style="display:flex;"><span>    Java.perform(<span style="color:#ff7b72">function</span> x() {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#a5d6ff">&#39;[+] script load&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> b <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;com.a.easyjava.b&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> a <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;com.a.easyjava.a&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> IntClass <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;java.lang.Integer&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> StringClass <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;java.lang.String&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> ArrayList <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;java.util.ArrayList&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> MainActivity <span style="color:#ff7b72;font-weight:bold">=</span> Java.use(<span style="color:#a5d6ff">&#34;com.a.easyjava.MainActivity&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> flag <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">new</span> Array();
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> cipher <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;wigwrkaugala&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> bvar <span style="color:#ff7b72;font-weight:bold">=</span> b.$new(IntClass.$new(<span style="color:#a5d6ff">2</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> avar <span style="color:#ff7b72;font-weight:bold">=</span> a.$new(IntClass.$new(<span style="color:#a5d6ff">3</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">for</span> (<span style="color:#ff7b72">var</span> _ <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span>; _ <span style="color:#ff7b72;font-weight:bold">&lt;</span> cipher.length; _<span style="color:#ff7b72;font-weight:bold">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">for</span> (<span style="color:#ff7b72">var</span> i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">97</span>; i <span style="color:#ff7b72;font-weight:bold">&lt;</span> <span style="color:#a5d6ff">123</span>; i<span style="color:#ff7b72;font-weight:bold">++</span>) { <span style="color:#8b949e;font-style:italic">// 97 - 123是字母a-z
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>                <span style="color:#8b949e;font-style:italic">// reset static value
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>                bvar._b.value <span style="color:#ff7b72;font-weight:bold">=</span> StringClass.$new(<span style="color:#a5d6ff">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>);
</span></span><span style="display:flex;"><span>                bvar.d.value <span style="color:#ff7b72;font-weight:bold">=</span> IntClass.$new(<span style="color:#a5d6ff">0</span>);
</span></span><span style="display:flex;"><span>                bvar._a.value <span style="color:#ff7b72;font-weight:bold">=</span> ArrayList.$new();
</span></span><span style="display:flex;"><span>                bvar[<span style="color:#a5d6ff">&#34;$init&#34;</span>](IntClass.$new(<span style="color:#a5d6ff">2</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                avar.b.value <span style="color:#ff7b72;font-weight:bold">=</span> StringClass.$new(<span style="color:#a5d6ff">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>);
</span></span><span style="display:flex;"><span>                avar.d.value <span style="color:#ff7b72;font-weight:bold">=</span> IntClass.$new(<span style="color:#a5d6ff">0</span>);
</span></span><span style="display:flex;"><span>                avar._a.value <span style="color:#ff7b72;font-weight:bold">=</span> ArrayList.$new();
</span></span><span style="display:flex;"><span>                avar[<span style="color:#a5d6ff">&#34;$init&#34;</span>](IntClass.$new(<span style="color:#a5d6ff">3</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">var</span> s <span style="color:#ff7b72;font-weight:bold">=</span> String.fromCharCode(i);
</span></span><span style="display:flex;"><span>                flag.push(s);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">for</span> (<span style="color:#ff7b72">var</span> e <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span>; e <span style="color:#ff7b72;font-weight:bold">&lt;</span> flag.length; e<span style="color:#ff7b72;font-weight:bold">++</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#ff7b72">var</span> c <span style="color:#ff7b72;font-weight:bold">=</span> MainActivity.a(flag[e].toString(), bvar, avar);
</span></span><span style="display:flex;"><span>                    <span style="color:#ff7b72">if</span> (c <span style="color:#ff7b72;font-weight:bold">!=</span> cipher[e]) {
</span></span><span style="display:flex;"><span>                        <span style="color:#ff7b72">break</span>;
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#ff7b72">if</span> (c <span style="color:#ff7b72;font-weight:bold">==</span> cipher[flag.length <span style="color:#ff7b72;font-weight:bold">-</span> <span style="color:#a5d6ff">1</span>]) {
</span></span><span style="display:flex;"><span>                    console.log(flag);
</span></span><span style="display:flex;"><span>                    <span style="color:#ff7b72">break</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                flag.length <span style="color:#ff7b72;font-weight:bold">-=</span> <span style="color:#a5d6ff">1</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#a5d6ff">&#39;flag{&#39;</span> <span style="color:#ff7b72;font-weight:bold">+</span> flag.join(<span style="color:#a5d6ff">&#39;&#39;</span>) <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#a5d6ff">&#39;}&#39;</span>);
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#a5d6ff">&#39;[+] script end&#39;</span>);
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>setImmediate(main);
</span></span></code></pre></td></tr></table>
</div>
</div><p>结果</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali ~/frida-script-dev# python3 loader.py
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">[</span>+<span style="color:#ff7b72;font-weight:bold">]</span> script load
</span></span><span style="display:flex;"><span>v
</span></span><span style="display:flex;"><span>v,e
</span></span><span style="display:flex;"><span>v,e,n
</span></span><span style="display:flex;"><span>v,e,n,i
</span></span><span style="display:flex;"><span>v,e,n,i,v
</span></span><span style="display:flex;"><span>v,e,n,i,v,i
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i,v
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i,v,i
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i,v,i,c
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i,v,i,c,i
</span></span><span style="display:flex;"><span>flag<span style="color:#ff7b72;font-weight:bold">{</span>veniviaivici<span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72;font-weight:bold">[</span>+<span style="color:#ff7b72;font-weight:bold">]</span> script end
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="参考">参考</h1>
<p>
<a href="https://eternalsakura13.com/2020/07/04/frida/" target="_blank" rel="noopener">Frida Android hook | Sakuraのblog (eternalsakura13.com)</a></p>
<p>
<a href="https://bbs.kanxue.com/thread-257745.htm" target="_blank" rel="noopener">52pojie2020春节红包-第三题（升级版）暴力破解</a></p>
<p>
<a href="http://www.manongjc.com/detail/23-ygwigcykklzbgnh.html" target="_blank" rel="noopener">frida主动调用app方法 - 码农教程 (manongjc.com)</a></p>
<p>
<a href="https://blog.csdn.net/weixin_39915210/article/details/114208140#:~:text=Java" target="_blank" rel="noopener">java static 区别_Java 静态与动态的区别_</a></p>
<p>
<a href="https://www.cnblogs.com/cainiao-chuanqi/p/13565030.html" target="_blank" rel="noopener">攻防世界新手练习题_MOBILE(移动) - 菜鸟-传奇 - 博客园 (cnblogs.com)</a></p>
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">Mi1itray.axe</span></span>
    
    <time>Jul 7, 2023</time>
    
      <span class="categories">
        Tags:
        
          <a class="category" href="https://military-axe.github.io/tags/reverse">reverse</a>  <a class="category" href="https://military-axe.github.io/tags/android">android</a>  <a class="category" href="https://military-axe.github.io/tags/frida">frida</a>  
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="https://military-axe.github.io/blog/2023-07-03-ida-symbolic-recovery/" title="Ida Symbolic Recovery">Ida Symbolic Recovery</a>
    

    
      <a class="basic-alignment right" href="https://military-axe.github.io/blog/2023-07-17-obfuscate-hide-string-zer0pts/" title="Obfuscate hide string &amp;&amp; zer0pts">Obfuscate hide string &amp;&amp; zer0pts</a>
    
  </p>
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    
      <h1>About</h1>
    

    <p>
      
        <p>mi1itray.axe&rsquo;s blog</p>
<p>This blog is mainly used to record my learning in the field of CTF. The main direction is Reverse.</p>
<p>You can use gpg to contact me, My public key in 
<a href="gpg_publickey.asc">here</a></p>

      
    </p>
  </section>

  
  



<ul class="sidebar-nav">
  <li class="sidebar-nav-item">
    <a target="_blank" rel="noopener noreferrer" href="https://github.com/Military-axe/" title="https://github.com/Military-axe/"><i class="fa fa-github fa-3x"></i></a>
    
    
    
    
    
    
    
    
    
    
    
    <a target="_blank" rel="noopener noreferrer" href="mailto:mi1itray.axe@gmail.com" title="mailto:mi1itray.axe@gmail.com"><i class="fa fa-envelope fa-3x"></i></a>

  
  
  </li>
</ul>

  

  
    
      <section class="odd">
        
          <h1>Friend link</h1>
        
        
          <li>
            <a href="https://h0pe-ay.github.io/" title="h0pe" >h0pe</a>
          </li>
        
          <li>
            <a href="http://locksec.top" title="l0ck" >l0ck</a>
          </li>
        
          <li>
            <a href="https://www.cnblogs.com/Ar3sh1/" title="Ar3sh1" >Ar3sh1</a>
          </li>
        
          <li>
            <a href="https://WyHlj.github.io/" title="fl3cha2o" >fl3cha2o</a>
          </li>
        
          <li>
            <a href="https://southsea.st/" title="southsea" >southsea</a>
          </li>
        
      </section>
    
  

  
  
  
    
      <section class="even">
        <h1>Recent Posts</h1>
        <ul id="recent_posts">
          
          
            
          
            
              <li class="post">
                <a href="/blog/2024-03-19-%E5%88%A9%E7%94%A8peb%E9%81%8D%E5%8E%86%E6%A8%A1%E5%9D%97%E9%93%BE%E8%A1%A8/">利用PEB遍历模块链表</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2024-03-02-rust%E6%B1%A1%E7%82%B9%E5%88%86%E6%9E%90%E8%B0%83%E7%A0%94/">Rust污点分析调研</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-10-16-2023-%E9%A6%99%E5%B1%B1%E6%9D%AF-reverse/">2023 香山杯 Reverse</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-10-12-bian-smart-contract-source-code-obfuscation/">BiAn: Smart Contract Source Code Obfuscation</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-09-27-2023-%E7%A0%94%E7%A9%B6%E7%94%9F%E5%9B%BD%E8%B5%9B-reverse/">2023 研究生国赛 Reverse</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-09-06-2023-%E7%BE%8A%E5%9F%8E%E6%9D%AF-reverse/">2023 羊城杯 Reverse</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-09-01-rtag-cli-tools-dev/">Rtag cli tools dev</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-08-19-binary-diffing-1/">Binary Diffing 1</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-07-23-khaos-the-impact-of-inter-procedural-code-obfuscation-on-binary-diffing-techniques/">Khaos: The Impact of Inter-procedural Code Obfuscation on Binary Diffing Techniques</a>
              </li>
            
          
        </ul>
      </section>
    
  
</aside>

  </div>
</div>

    <footer role="contentinfo">
      <p>Copyright &copy; 2024 Mi1itray.axe - <a href="https://military-axe.github.io/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io" rel="noopener noreferrer">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/" rel="noopener noreferrer">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    



    
    
    

    
  </body>
</html>

