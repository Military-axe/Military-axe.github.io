<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  

  
  <title>Obfuscate hide string &amp;&amp; zer0pts</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="/css/fork-awesome.min.css">
  

  
  
    <link href="https://military-axe.github.io/myfavicon.jpg" rel="icon">
  

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="">
  <meta name="author" content="Mi1itray.axe">

  
  <meta name="generator" content="Hugo 0.113.0">

  
  

  
  



</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="https://military-axe.github.io/">mi1itray.axe</a></h1>
    <h2>mi1itray.axe@gmail.com</h2>
</hgroup></header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
        <option value="https://military-axe.github.io/">» Blog</option>
      
        <option value="https://military-axe.github.io/categories">» Categories</option>
      
        <option value="https://military-axe.github.io/tags">» Tags</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="https://military-axe.github.io/" title="Blog">Blog</a></li>
    
  
    
      <li><a href="https://military-axe.github.io/categories" title="Categories"  target="_blank"  rel="noopener noreferrer">Categories</a></li>
    
  
    
      <li><a href="https://military-axe.github.io/tags" title="Tags"  target="_blank"  rel="noopener noreferrer">Tags</a></li>
    
  
</ul>

<ul class="subscription">
  
    
        <a href="https://military-axe.github.io/index.xml" target="_blank" type="application/rss+xml" title="RSS" rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
    
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank" rel="noopener noreferrer">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:https://military-axe.github.io/" />
    </fieldset>
  </form>

</nav>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
    integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4"
    crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
    integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">Jul 17, 2023
     - 10 minute read 
    

    
    
      - <a class="label" href="https://military-axe.github.io/categories/reverse/">Reverse </a>
    
  </p>
  <h1 class="entry-title">
     Obfuscate hide string &amp;&amp; zer0pts 
  </h1>
</header>


        <div class="entry-content">
          
          
          
            <nav id="TableOfContents">
  <ul>
    <li><a href="#obfuscate-项目使用">Obfuscate 项目使用</a></li>
    <li><a href="#zer0pts-mimikyu">zer0pts mimikyu</a></li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
          
          <p>Obfuscate项目是用于隐藏字符串，增加分析的难度，但是Obfuscate只能对抗静态的分析。zer0pts比赛中的一题就是利用这个项目，但是它很巧妙，隐藏的是模块的函数名，主要逻辑是调用so文件的模块，它隐藏so中的函数名后，从静态分析是很难看出来调用的逻辑是什么，忽然感觉这个项目就有点用了。</p>
<h1 id="obfuscate-项目使用">Obfuscate 项目使用</h1>
<p>github地址：
<a href="https://github.com/adamyaxley/Obfuscate" target="_blank" rel="noopener">adamyaxley/Obfuscate: Guaranteed compile-time string literal obfuscation header-only library for C++14 (github.com)</a></p>
<p>这个项目是对字符串进行加密与解密的一个项目，使用非常简单。</p>
<ol>
<li>复制<code>obfuscate.h</code> 到项目中并include进去</li>
<li>封装字符串<code>AY_OBFUSCATE(&quot;My String&quot;)</code></li>
</ol>
<p>源码</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#8b949e;font-weight:bold;font-style:italic">#include</span> <span style="color:#8b949e;font-weight:bold;font-style:italic">&lt;iostream&gt;</span><span style="color:#8b949e;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-weight:bold;font-style:italic">#include</span> <span style="color:#8b949e;font-weight:bold;font-style:italic">&lt;string&gt;</span><span style="color:#8b949e;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-weight:bold;font-style:italic">#include</span> <span style="color:#8b949e;font-weight:bold;font-style:italic">&#34;obfuscate.h&#34;</span><span style="color:#8b949e;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">int</span> <span style="color:#d2a8ff;font-weight:bold">main</span>() 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#ff7b72">const</span> std<span style="color:#ff7b72;font-weight:bold">::</span>string username(AY_OBFUSCATE(<span style="color:#a5d6ff">&#34;root&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#ff7b72">const</span> std<span style="color:#ff7b72;font-weight:bold">::</span>string password(AY_OBFUSCATE(<span style="color:#a5d6ff">&#34;password&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	std<span style="color:#ff7b72;font-weight:bold">::</span>cout <span style="color:#ff7b72;font-weight:bold">&lt;&lt;</span> <span style="color:#a5d6ff">&#34;Obfuscate naive login example (bloat test)&#34;</span> <span style="color:#ff7b72;font-weight:bold">&lt;&lt;</span> std<span style="color:#ff7b72;font-weight:bold">::</span>endl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	std<span style="color:#ff7b72;font-weight:bold">::</span>string input_username;
</span></span><span style="display:flex;"><span>	std<span style="color:#ff7b72;font-weight:bold">::</span>string input_password;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff7b72">while</span> (true)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		std<span style="color:#ff7b72;font-weight:bold">::</span>cout <span style="color:#ff7b72;font-weight:bold">&lt;&lt;</span> <span style="color:#a5d6ff">&#34;Username: &#34;</span>;
</span></span><span style="display:flex;"><span>		std<span style="color:#ff7b72;font-weight:bold">::</span>cin <span style="color:#ff7b72;font-weight:bold">&gt;&gt;</span> input_username;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		std<span style="color:#ff7b72;font-weight:bold">::</span>cout <span style="color:#ff7b72;font-weight:bold">&lt;&lt;</span> <span style="color:#a5d6ff">&#34;Password: &#34;</span>;
</span></span><span style="display:flex;"><span>		std<span style="color:#ff7b72;font-weight:bold">::</span>cin <span style="color:#ff7b72;font-weight:bold">&gt;&gt;</span> input_password;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ff7b72">if</span> (input_username <span style="color:#ff7b72;font-weight:bold">==</span> username <span style="color:#ff7b72;font-weight:bold">&amp;&amp;</span> input_password <span style="color:#ff7b72;font-weight:bold">==</span> password)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			std<span style="color:#ff7b72;font-weight:bold">::</span>cout <span style="color:#ff7b72;font-weight:bold">&lt;&lt;</span> <span style="color:#a5d6ff">&#34;Login success!&#34;</span> <span style="color:#ff7b72;font-weight:bold">&lt;&lt;</span> std<span style="color:#ff7b72;font-weight:bold">::</span>endl;
</span></span><span style="display:flex;"><span>			<span style="color:#ff7b72">break</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			std<span style="color:#ff7b72;font-weight:bold">::</span>cout <span style="color:#ff7b72;font-weight:bold">&lt;&lt;</span> <span style="color:#a5d6ff">&#34;Login failure: unrecognised username and password&#34;</span>
</span></span><span style="display:flex;"><span>				<span style="color:#a5d6ff">&#34;combination.&#34;</span> <span style="color:#ff7b72;font-weight:bold">&lt;&lt;</span> std<span style="color:#ff7b72;font-weight:bold">::</span>endl;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ida打开分析后，发现</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>	<span style="color:#ff7b72">const</span> std<span style="color:#ff7b72;font-weight:bold">::</span>string username(AY_OBFUSCATE(<span style="color:#a5d6ff">&#34;root&#34;</span>));
</span></span><span style="display:flex;"><span>	<span style="color:#ff7b72">const</span> std<span style="color:#ff7b72;font-weight:bold">::</span>string password(AY_OBFUSCATE(<span style="color:#a5d6ff">&#34;password&#34;</span>));
</span></span></code></pre></td></tr></table>
</div>
</div><p>中的两个字符串找不到了，他们无法被静态的找到了，但是动态运行起来后，还是可以在内存中找到这个字符串。所以这个项目只能防护静态分析字符串。</p>
<p>如果只是防护字符串，那还是挺鸡肋的。下面这题用这个隐藏需要调用的函数名，一次来做一个隐藏函数逻辑的方法有一点意思。</p>
<h1 id="zer0pts-mimikyu">zer0pts mimikyu</h1>
<p>题目地址：
<a href="https://github.com/Military-axe/ctf/tree/master/2023/mimikyu" target="_blank" rel="noopener">ctf/2023/mimikyu at master · Military-axe/ctf (github.com)</a></p>
<p>程序很直白，打开main函数看到几乎所有代码</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">81
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ff7b72">int</span> <span style="color:#ff7b72">__cdecl</span> <span style="color:#d2a8ff;font-weight:bold">main</span>(<span style="color:#ff7b72">int</span> argc, <span style="color:#ff7b72">const</span> <span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">**</span>argv, <span style="color:#ff7b72">const</span> <span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">__int64</span> v4; <span style="color:#8b949e;font-style:italic">// rdx
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> v5; <span style="color:#8b949e;font-style:italic">// rdx
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">__int64</span> i; <span style="color:#8b949e;font-style:italic">// [rsp+18h] [rbp-78h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">__int64</span> j; <span style="color:#8b949e;font-style:italic">// [rsp+20h] [rbp-70h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">__int64</span> k; <span style="color:#8b949e;font-style:italic">// [rsp+28h] [rbp-68h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">*</span>s; <span style="color:#8b949e;font-style:italic">// [rsp+30h] [rbp-60h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">void</span> <span style="color:#ff7b72;font-weight:bold">*</span>LibraryA; <span style="color:#8b949e;font-style:italic">// [rsp+40h] [rbp-50h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">void</span> <span style="color:#ff7b72;font-weight:bold">*</span>libgmp; <span style="color:#8b949e;font-style:italic">// [rsp+48h] [rbp-48h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">char</span> v12[<span style="color:#a5d6ff">16</span>]; <span style="color:#8b949e;font-style:italic">// [rsp+50h] [rbp-40h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">char</span> v13[<span style="color:#a5d6ff">16</span>]; <span style="color:#8b949e;font-style:italic">// [rsp+60h] [rbp-30h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">char</span> v14[<span style="color:#a5d6ff">24</span>]; <span style="color:#8b949e;font-style:italic">// [rsp+70h] [rbp-20h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">__int64</span> v15; <span style="color:#8b949e;font-style:italic">// [rsp+88h] [rbp-8h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>
</span></span><span style="display:flex;"><span>  v15 <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">__readfsqword</span>(<span style="color:#a5d6ff">0x28u</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> ( argc <span style="color:#ff7b72;font-weight:bold">&gt;</span> <span style="color:#a5d6ff">1</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    s <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">*</span>)argv[<span style="color:#a5d6ff">1</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> ( <span style="color:#d2a8ff;font-weight:bold">strlen</span>(s) <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">40</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      LibraryA <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">void</span> <span style="color:#ff7b72;font-weight:bold">*</span>)<span style="color:#d2a8ff;font-weight:bold">LoadLibraryA</span>(<span style="color:#a5d6ff">&#34;libc.so.6&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">if</span> ( <span style="color:#ff7b72;font-weight:bold">!</span>LibraryA )
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">__assert_fail</span>(<span style="color:#a5d6ff">&#34;hLibc != NULL&#34;</span>, <span style="color:#a5d6ff">&#34;main.c&#34;</span>, <span style="color:#a5d6ff">0x4Au</span>, <span style="color:#a5d6ff">&#34;main&#34;</span>);
</span></span><span style="display:flex;"><span>      libgmp <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">void</span> <span style="color:#ff7b72;font-weight:bold">*</span>)<span style="color:#d2a8ff;font-weight:bold">LoadLibraryA</span>(<span style="color:#a5d6ff">&#34;libgmp.so&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">if</span> ( <span style="color:#ff7b72;font-weight:bold">!</span>libgmp )
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">__assert_fail</span>(<span style="color:#a5d6ff">&#34;hGMP != NULL&#34;</span>, <span style="color:#a5d6ff">&#34;main.c&#34;</span>, <span style="color:#a5d6ff">0x4Cu</span>, <span style="color:#a5d6ff">&#34;main&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">1907704461</span>, v12);
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">1907704461</span>, v13);
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">1907704461</span>, v14);
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">58821864</span>, <span style="color:#ff7b72;font-weight:bold">*</span>(<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span> <span style="color:#ff7b72;font-weight:bold">*</span>)main);
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1810257824</span>, _bss_start, <span style="color:#a5d6ff">0LL</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">printf</span>(<span style="color:#a5d6ff">&#34;Checking...&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">for</span> ( i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0LL</span>; i <span style="color:#ff7b72;font-weight:bold">&lt;</span> <span style="color:#a5d6ff">0x28</span>; <span style="color:#ff7b72;font-weight:bold">++</span>i )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> ( <span style="color:#ff7b72;font-weight:bold">!</span>(<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">1317667610</span>, (<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span>)s[i]) )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span><span style="color:#79c0ff;font-weight:bold">LABEL_21</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#d2a8ff;font-weight:bold">puts</span>(<span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\n</span><span style="color:#a5d6ff">Wrong.&#34;</span>);
</span></span><span style="display:flex;"><span>          <span style="color:#ff7b72">goto</span> LABEL_22;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">for</span> ( j <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0LL</span>; j <span style="color:#ff7b72;font-weight:bold">&lt;</span> <span style="color:#a5d6ff">0x28</span>; j <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#a5d6ff">4LL</span> )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">249367710</span>, v13, <span style="color:#a5d6ff">1LL</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">for</span> ( k <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0LL</span>; k <span style="color:#ff7b72;font-weight:bold">&lt;=</span> <span style="color:#a5d6ff">2</span>; <span style="color:#ff7b72;font-weight:bold">++</span>k )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">13994153</span>, <span style="color:#a5d6ff">46LL</span>);
</span></span><span style="display:flex;"><span>          v4 <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">2070735453</span>) <span style="color:#ff7b72;font-weight:bold">%</span> <span style="color:#a5d6ff">0x10000</span>;
</span></span><span style="display:flex;"><span>          <span style="color:#d2a8ff;font-weight:bold">cap</span>(LibraryA, libgmp, v4, v12);
</span></span><span style="display:flex;"><span>          <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">880641627</span>, v13, v13, v12);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">13994153</span>, <span style="color:#a5d6ff">46LL</span>);
</span></span><span style="display:flex;"><span>        v5 <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">2070735453</span>) <span style="color:#ff7b72;font-weight:bold">%</span> <span style="color:#a5d6ff">0x10000</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">cap</span>(LibraryA, libgmp, v5, v14);
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">249367710</span>, v12, <span style="color:#ff7b72;font-weight:bold">*</span>(<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span> <span style="color:#ff7b72;font-weight:bold">*</span>)<span style="color:#ff7b72;font-weight:bold">&amp;</span>s[j]);
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1876728194</span>, v12, v12, v14, v13);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> ( (<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1309138724</span>, v12, encoded[j <span style="color:#ff7b72;font-weight:bold">&gt;&gt;</span> <span style="color:#a5d6ff">2</span>]) )
</span></span><span style="display:flex;"><span>          <span style="color:#ff7b72">goto</span> LABEL_21;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">puts</span>(<span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\n</span><span style="color:#a5d6ff">Correct!&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#79c0ff;font-weight:bold">LABEL_22</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">835473311</span>, v12);<span style="color:#8b949e;font-style:italic">// gmpz_clean
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">835473311</span>, v13);<span style="color:#8b949e;font-style:italic">// gmpz_clean
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">835473311</span>, v14);<span style="color:#8b949e;font-style:italic">// gmpz_clean
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">CloseHandle</span>(LibraryA);
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">CloseHandle</span>(libgmp);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">puts</span>(<span style="color:#a5d6ff">&#34;Nowhere near close.&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">printf</span>(<span style="color:#a5d6ff">&#34;Usage: %s FLAG</span><span style="color:#79c0ff">\n</span><span style="color:#a5d6ff">&#34;</span>, <span style="color:#ff7b72;font-weight:bold">*</span>argv);
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>会发现<code>ResolveModuleFunction</code>函数调用两个so文件模块。其实也可以才出来，应该是调用模块中的函数做一个运算吗，但是用<code>ResolveModuleFunction</code>来隐藏具体调用的是哪个函数。</p>
<p>接下来打开<code>ResolveModuleFunction</code>函数，看看这个函数做了什么</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">77
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ff7b72">__int64</span> <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(<span style="color:#ff7b72">void</span> <span style="color:#ff7b72;font-weight:bold">*</span>a1, <span style="color:#ff7b72">int</span> a2, ...)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">__int64</span> v2; <span style="color:#8b949e;font-style:italic">// rax
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> <span style="color:#ff7b72;font-weight:bold">*</span>overflow_arg_area; <span style="color:#8b949e;font-style:italic">// rax
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">int</span> v5; <span style="color:#8b949e;font-style:italic">// [rsp+18h] [rbp-158h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">int</span> j; <span style="color:#8b949e;font-style:italic">// [rsp+1Ch] [rbp-154h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">int</span> k; <span style="color:#8b949e;font-style:italic">// [rsp+20h] [rbp-150h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">int</span> v8; <span style="color:#8b949e;font-style:italic">// [rsp+24h] [rbp-14Ch]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> v9; <span style="color:#8b949e;font-style:italic">// [rsp+28h] [rbp-148h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> v10; <span style="color:#8b949e;font-style:italic">// [rsp+30h] [rbp-140h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> v11; <span style="color:#8b949e;font-style:italic">// [rsp+38h] [rbp-138h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> v12; <span style="color:#8b949e;font-style:italic">// [rsp+40h] [rbp-130h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> <span style="color:#ff7b72;font-weight:bold">*</span>i; <span style="color:#8b949e;font-style:italic">// [rsp+48h] [rbp-128h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span> <span style="color:#ff7b72;font-weight:bold">*</span>v14; <span style="color:#8b949e;font-style:italic">// [rsp+50h] [rbp-120h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">*</span>name; <span style="color:#8b949e;font-style:italic">// [rsp+58h] [rbp-118h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> (<span style="color:#ff7b72">__fastcall</span> <span style="color:#ff7b72;font-weight:bold">*</span>v16)(<span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>); <span style="color:#8b949e;font-style:italic">// [rsp+60h] [rbp-110h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  gcc_va_list va; <span style="color:#8b949e;font-style:italic">// [rsp+68h] [rbp-108h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> v18[<span style="color:#a5d6ff">8</span>]; <span style="color:#8b949e;font-style:italic">// [rsp+80h] [rbp-F0h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">va_start</span>(va, a2);
</span></span><span style="display:flex;"><span>  v18[<span style="color:#a5d6ff">7</span>] <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">__readfsqword</span>(<span style="color:#a5d6ff">0x28u</span>);
</span></span><span style="display:flex;"><span>  v9 <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0LL</span>;
</span></span><span style="display:flex;"><span>  v12 <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0LL</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> ( <span style="color:#ff7b72;font-weight:bold">!</span>(<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">GetModuleInformation</span>(a1, <span style="color:#ff7b72;font-weight:bold">&amp;</span>v9) )
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">__assert_fail</span>(<span style="color:#a5d6ff">&#34;GetModuleInformation(hModule, &amp;lpmodinfo)&#34;</span>, <span style="color:#a5d6ff">&#34;obfuscate.h&#34;</span>, <span style="color:#a5d6ff">0x71u</span>, <span style="color:#a5d6ff">&#34;ResolveModuleFunction&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">for</span> ( i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72;font-weight:bold">*</span>(<span style="color:#ff7b72">__int64</span> <span style="color:#ff7b72;font-weight:bold">**</span>)(v9 <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#a5d6ff">16</span>); <span style="color:#ff7b72;font-weight:bold">*</span>i; i <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#a5d6ff">2</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    v2 <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72;font-weight:bold">*</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> ( <span style="color:#ff7b72;font-weight:bold">*</span>i <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">11</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v5 <span style="color:#ff7b72;font-weight:bold">=</span> i[<span style="color:#a5d6ff">1</span>];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">else</span> <span style="color:#ff7b72">if</span> ( v2 <span style="color:#ff7b72;font-weight:bold">&lt;=</span> <span style="color:#a5d6ff">11</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">if</span> ( v2 <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">5</span> )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        v11 <span style="color:#ff7b72;font-weight:bold">=</span> i[<span style="color:#a5d6ff">1</span>];
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">else</span> <span style="color:#ff7b72">if</span> ( v2 <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">6</span> )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        v10 <span style="color:#ff7b72;font-weight:bold">=</span> i[<span style="color:#a5d6ff">1</span>];
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#d2a8ff;font-weight:bold">dlerror</span>();
</span></span><span style="display:flex;"><span>  v8 <span style="color:#ff7b72;font-weight:bold">=</span> v11 <span style="color:#ff7b72;font-weight:bold">-</span> v10;
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">for</span> ( j <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span>; j <span style="color:#ff7b72;font-weight:bold">&lt;</span> v8 <span style="color:#ff7b72;font-weight:bold">/</span> v5; <span style="color:#ff7b72;font-weight:bold">++</span>j )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    v14 <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span> <span style="color:#ff7b72;font-weight:bold">*</span>)(<span style="color:#a5d6ff">24LL</span> <span style="color:#ff7b72;font-weight:bold">*</span> j <span style="color:#ff7b72;font-weight:bold">+</span> v10);
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> ( (v14[<span style="color:#a5d6ff">1</span>] <span style="color:#ff7b72;font-weight:bold">&amp;</span> <span style="color:#a5d6ff">0xF</span>) <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">2</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      name <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">*</span>)(<span style="color:#ff7b72;font-weight:bold">*</span>v14 <span style="color:#ff7b72;font-weight:bold">+</span> v11);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">if</span> ( a2 <span style="color:#ff7b72;font-weight:bold">==</span> (<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">CryptGetHashParam</span>(name) )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        v16 <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">__int64</span> (<span style="color:#ff7b72">__fastcall</span> <span style="color:#ff7b72;font-weight:bold">*</span>)(<span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>))<span style="color:#d2a8ff;font-weight:bold">dlsym</span>(a1, name);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> ( <span style="color:#d2a8ff;font-weight:bold">dlerror</span>() )
</span></span><span style="display:flex;"><span>          <span style="color:#d2a8ff;font-weight:bold">BUG</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">for</span> ( k <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0</span>; k <span style="color:#ff7b72;font-weight:bold">&lt;=</span> <span style="color:#a5d6ff">5</span>; <span style="color:#ff7b72;font-weight:bold">++</span>k )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#ff7b72">if</span> ( va[<span style="color:#a5d6ff">0</span>].gp_offset <span style="color:#ff7b72;font-weight:bold">&gt;</span> <span style="color:#a5d6ff">0x2F</span> )
</span></span><span style="display:flex;"><span>          {
</span></span><span style="display:flex;"><span>            overflow_arg_area <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">__int64</span> <span style="color:#ff7b72;font-weight:bold">*</span>)va[<span style="color:#a5d6ff">0</span>].overflow_arg_area;
</span></span><span style="display:flex;"><span>            va[<span style="color:#a5d6ff">0</span>].overflow_arg_area <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">*</span>)va[<span style="color:#a5d6ff">0</span>].overflow_arg_area <span style="color:#ff7b72;font-weight:bold">+</span> <span style="color:#a5d6ff">8</span>;
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>          {
</span></span><span style="display:flex;"><span>            overflow_arg_area <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">__int64</span> <span style="color:#ff7b72;font-weight:bold">*</span>)((<span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">*</span>)va[<span style="color:#a5d6ff">0</span>].reg_save_area <span style="color:#ff7b72;font-weight:bold">+</span> va[<span style="color:#a5d6ff">0</span>].gp_offset);
</span></span><span style="display:flex;"><span>            va[<span style="color:#a5d6ff">0</span>].gp_offset <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#a5d6ff">8</span>;
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          v18[k] <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72;font-weight:bold">*</span>overflow_arg_area;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">return</span> <span style="color:#d2a8ff;font-weight:bold">v16</span>(v18[<span style="color:#a5d6ff">0</span>], v18[<span style="color:#a5d6ff">1</span>], v18[<span style="color:#a5d6ff">2</span>], v18[<span style="color:#a5d6ff">3</span>], v18[<span style="color:#a5d6ff">4</span>], v18[<span style="color:#a5d6ff">5</span>]);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">return</span> v12;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到很关键的两句，一句是</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>v16 <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">__int64</span> (<span style="color:#ff7b72">__fastcall</span> <span style="color:#ff7b72;font-weight:bold">*</span>)(<span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>, <span style="color:#ff7b72">__int64</span>))<span style="color:#d2a8ff;font-weight:bold">dlsym</span>(a1, name);
</span></span></code></pre></td></tr></table>
</div>
</div><p>一句是</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span> <span style="color:#ff7b72">return</span> <span style="color:#d2a8ff;font-weight:bold">v16</span>(v18[<span style="color:#a5d6ff">0</span>], v18[<span style="color:#a5d6ff">1</span>], v18[<span style="color:#a5d6ff">2</span>], v18[<span style="color:#a5d6ff">3</span>], v18[<span style="color:#a5d6ff">4</span>], v18[<span style="color:#a5d6ff">5</span>]);
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以知道，前面都是解密运算真正的函数名，然后调用<code>dlsym</code>就可以获取对应函数的指针，再调用函数指针来运行此函数，做到一个隐藏真正调用函数的过程。</p>
<p>既然知道了这个流程，也非常简单，查看每次调用<code>ResolveModuleFunction</code>时，在<code>dlsym(a1, name)</code>中的name参数，也就知道此时的<code>ResolveModuleFunction</code>等同于那个函数了。</p>
<p><img src="https://raw.githubusercontent.com/Military-axe/imgtable/main/202307171225131.png" alt="image-20230717122504520"></p>
<p>还原全部的调用后如下</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">81
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ff7b72">int</span> <span style="color:#ff7b72">__cdecl</span> <span style="color:#d2a8ff;font-weight:bold">main</span>(<span style="color:#ff7b72">int</span> argc, <span style="color:#ff7b72">const</span> <span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">**</span>argv, <span style="color:#ff7b72">const</span> <span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">__int64</span> v4; <span style="color:#8b949e;font-style:italic">// rdx
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">__int64</span> v5; <span style="color:#8b949e;font-style:italic">// rdx
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">__int64</span> i; <span style="color:#8b949e;font-style:italic">// [rsp+18h] [rbp-78h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">__int64</span> j; <span style="color:#8b949e;font-style:italic">// [rsp+20h] [rbp-70h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">__int64</span> k; <span style="color:#8b949e;font-style:italic">// [rsp+28h] [rbp-68h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">*</span>s; <span style="color:#8b949e;font-style:italic">// [rsp+30h] [rbp-60h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">void</span> <span style="color:#ff7b72;font-weight:bold">*</span>LibraryA; <span style="color:#8b949e;font-style:italic">// [rsp+40h] [rbp-50h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">void</span> <span style="color:#ff7b72;font-weight:bold">*</span>libgmp; <span style="color:#8b949e;font-style:italic">// [rsp+48h] [rbp-48h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">char</span> v12[<span style="color:#a5d6ff">16</span>]; <span style="color:#8b949e;font-style:italic">// [rsp+50h] [rbp-40h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">char</span> v13[<span style="color:#a5d6ff">16</span>]; <span style="color:#8b949e;font-style:italic">// [rsp+60h] [rbp-30h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">char</span> v14[<span style="color:#a5d6ff">24</span>]; <span style="color:#8b949e;font-style:italic">// [rsp+70h] [rbp-20h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">__int64</span> v15; <span style="color:#8b949e;font-style:italic">// [rsp+88h] [rbp-8h]
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>
</span></span><span style="display:flex;"><span>  v15 <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#d2a8ff;font-weight:bold">__readfsqword</span>(<span style="color:#a5d6ff">0x28u</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">if</span> ( argc <span style="color:#ff7b72;font-weight:bold">&gt;</span> <span style="color:#a5d6ff">1</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    s <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">char</span> <span style="color:#ff7b72;font-weight:bold">*</span>)argv[<span style="color:#a5d6ff">1</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">if</span> ( <span style="color:#d2a8ff;font-weight:bold">strlen</span>(s) <span style="color:#ff7b72;font-weight:bold">==</span> <span style="color:#a5d6ff">40</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      LibraryA <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">void</span> <span style="color:#ff7b72;font-weight:bold">*</span>)<span style="color:#d2a8ff;font-weight:bold">LoadLibraryA</span>(<span style="color:#a5d6ff">&#34;libc.so.6&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">if</span> ( <span style="color:#ff7b72;font-weight:bold">!</span>LibraryA )
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">__assert_fail</span>(<span style="color:#a5d6ff">&#34;hLibc != NULL&#34;</span>, <span style="color:#a5d6ff">&#34;main.c&#34;</span>, <span style="color:#a5d6ff">0x4Au</span>, <span style="color:#a5d6ff">&#34;main&#34;</span>);
</span></span><span style="display:flex;"><span>      libgmp <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">void</span> <span style="color:#ff7b72;font-weight:bold">*</span>)<span style="color:#d2a8ff;font-weight:bold">LoadLibraryA</span>(<span style="color:#a5d6ff">&#34;libgmp.so&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">if</span> ( <span style="color:#ff7b72;font-weight:bold">!</span>libgmp )
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">__assert_fail</span>(<span style="color:#a5d6ff">&#34;hGMP != NULL&#34;</span>, <span style="color:#a5d6ff">&#34;main.c&#34;</span>, <span style="color:#a5d6ff">0x4Cu</span>, <span style="color:#a5d6ff">&#34;main&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">1907704461</span>, v12);<span style="color:#8b949e;font-style:italic">// gmpz_init
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">1907704461</span>, v13);<span style="color:#8b949e;font-style:italic">// gmpz_init
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">1907704461</span>, v14);<span style="color:#8b949e;font-style:italic">// gmpz_init
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">58821864</span>, <span style="color:#ff7b72;font-weight:bold">*</span>(<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span> <span style="color:#ff7b72;font-weight:bold">*</span>)main);<span style="color:#8b949e;font-style:italic">// srand
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1810257824</span>, _bss_start, <span style="color:#a5d6ff">0LL</span>);<span style="color:#8b949e;font-style:italic">// setbuf
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">printf</span>(<span style="color:#a5d6ff">&#34;Checking...&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">for</span> ( i <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0LL</span>; i <span style="color:#ff7b72;font-weight:bold">&lt;</span> <span style="color:#a5d6ff">0x28</span>; <span style="color:#ff7b72;font-weight:bold">++</span>i )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> ( <span style="color:#ff7b72;font-weight:bold">!</span>(<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">1317667610</span>, (<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span>)s[i]) )<span style="color:#8b949e;font-style:italic">// isprint
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>        {
</span></span><span style="display:flex;"><span><span style="color:#79c0ff;font-weight:bold">LABEL_21</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#d2a8ff;font-weight:bold">puts</span>(<span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\n</span><span style="color:#a5d6ff">Wrong.&#34;</span>);
</span></span><span style="display:flex;"><span>          <span style="color:#ff7b72">goto</span> LABEL_22;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">for</span> ( j <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0LL</span>; j <span style="color:#ff7b72;font-weight:bold">&lt;</span> <span style="color:#a5d6ff">0x28</span>; j <span style="color:#ff7b72;font-weight:bold">+=</span> <span style="color:#a5d6ff">4LL</span> )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">249367710</span>, v13, <span style="color:#a5d6ff">1LL</span>);<span style="color:#8b949e;font-style:italic">// gmpz_set_ui
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>        <span style="color:#ff7b72">for</span> ( k <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">0LL</span>; k <span style="color:#ff7b72;font-weight:bold">&lt;=</span> <span style="color:#a5d6ff">2</span>; <span style="color:#ff7b72;font-weight:bold">++</span>k )
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">13994153</span>, <span style="color:#a5d6ff">&#39;.&#39;</span>);<span style="color:#8b949e;font-style:italic">// putchar
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>          v4 <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">2070735453</span>) <span style="color:#ff7b72;font-weight:bold">%</span> <span style="color:#a5d6ff">0x10000</span>;<span style="color:#8b949e;font-style:italic">// rand
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>          <span style="color:#d2a8ff;font-weight:bold">cap</span>(LibraryA, libgmp, v4, (<span style="color:#ff7b72">__int64</span>)v12);
</span></span><span style="display:flex;"><span>          <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">880641627</span>, v13, v13, v12);<span style="color:#8b949e;font-style:italic">// gmpz_mul
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">13994153</span>, <span style="color:#a5d6ff">&#39;.&#39;</span>);
</span></span><span style="display:flex;"><span>        v5 <span style="color:#ff7b72;font-weight:bold">=</span> (<span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(LibraryA, <span style="color:#a5d6ff">2070735453</span>) <span style="color:#ff7b72;font-weight:bold">%</span> <span style="color:#a5d6ff">0x10000</span>;<span style="color:#8b949e;font-style:italic">// rand
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>        <span style="color:#d2a8ff;font-weight:bold">cap</span>(LibraryA, libgmp, v5, (<span style="color:#ff7b72">__int64</span>)v14);
</span></span><span style="display:flex;"><span>        <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">249367710</span>, v12, <span style="color:#ff7b72;font-weight:bold">*</span>(<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span> <span style="color:#ff7b72;font-weight:bold">*</span>)<span style="color:#ff7b72;font-weight:bold">&amp;</span>s[j]);<span style="color:#8b949e;font-style:italic">// gmpz_set_ui
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>        <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1876728194</span>, v12, v12, v14, v13);<span style="color:#8b949e;font-style:italic">// gmpz_pown
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>        <span style="color:#ff7b72">if</span> ( (<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1309138724</span>, v12, encoded[j <span style="color:#ff7b72;font-weight:bold">&gt;&gt;</span> <span style="color:#a5d6ff">2</span>]) )<span style="color:#8b949e;font-style:italic">// gmpz_cmp_ui
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>          <span style="color:#ff7b72">goto</span> LABEL_21;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">puts</span>(<span style="color:#a5d6ff">&#34;</span><span style="color:#79c0ff">\n</span><span style="color:#a5d6ff">Correct!&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#79c0ff;font-weight:bold">LABEL_22</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">835473311</span>, v12);<span style="color:#8b949e;font-style:italic">// gmpz_clean
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">835473311</span>, v13);<span style="color:#8b949e;font-style:italic">// gmpz_clean
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#a5d6ff">835473311</span>, v14);<span style="color:#8b949e;font-style:italic">// gmpz_clean
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>      <span style="color:#d2a8ff;font-weight:bold">CloseHandle</span>(LibraryA);
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">CloseHandle</span>(libgmp);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#d2a8ff;font-weight:bold">puts</span>(<span style="color:#a5d6ff">&#34;Nowhere near close.&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">else</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#d2a8ff;font-weight:bold">printf</span>(<span style="color:#a5d6ff">&#34;Usage: %s FLAG</span><span style="color:#79c0ff">\n</span><span style="color:#a5d6ff">&#34;</span>, <span style="color:#ff7b72;font-weight:bold">*</span>argv);
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> <span style="color:#a5d6ff">1</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>最重要的是下面这两句</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">249367710</span>, v12, <span style="color:#ff7b72;font-weight:bold">*</span>(<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span> <span style="color:#ff7b72;font-weight:bold">*</span>)<span style="color:#ff7b72;font-weight:bold">&amp;</span>s[j]);<span style="color:#8b949e;font-style:italic">// gmpz_set_ui
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span><span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1876728194</span>, v12, v12, v14, v13);<span style="color:#8b949e;font-style:italic">// gmpz_pown
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span><span style="color:#ff7b72">if</span> ( (<span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">int</span>)<span style="color:#d2a8ff;font-weight:bold">ResolveModuleFunction</span>(libgmp, <span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1309138724</span>, v12, encoded[j <span style="color:#ff7b72;font-weight:bold">&gt;&gt;</span> <span style="color:#a5d6ff">2</span>]) )<span style="color:#8b949e;font-style:italic">// gmpz_cmp_ui
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>     <span style="color:#ff7b72">goto</span> LABEL_21;
</span></span></code></pre></td></tr></table>
</div>
</div><p>首先是读输入4个字符当做一个32bit数据，然后放入gmpz_pown中加密。其实libgmp是一个大数运算库，可以查到函数调声明的。</p>
<p><code>gmpz_pown</code>就和python中的pow函数类似，需要三个参数<code>pow(a, b, c)</code>计算的就是 \(a^b\bmod c\) 。</p>
<p>此时a是我们输入的值也就是flag，b，c可以通过动态调试获得。需要注意的值，调用的参数是一个结构体，所以通过查询文档，确定gmp库中调用参数类型结构体如下</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ff7b72">void</span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">mpz_powm</span> (mpz_ptr r, mpz_srcptr b, mpz_srcptr e, mpz_srcptr m)<span style="color:#8b949e;font-style:italic">// 函数声明，结构体是mpz_t
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">typedef</span> __mpz_struct <span style="color:#ff7b72;font-weight:bold">*</span>mpz_ptr;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">typedef</span> <span style="color:#ff7b72">struct</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">int</span> _mp_alloc;		<span style="color:#8b949e;font-style:italic">/* Number of *limbs* allocated and pointed
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">				   to by the _mp_d field.  */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">int</span> _mp_size;			<span style="color:#8b949e;font-style:italic">/* abs(_mp_size) is the number of limbs the
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">				   last field points to.  If _mp_size is
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">				   negative this is a negative number.  */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">mp_limb_t</span> <span style="color:#ff7b72;font-weight:bold">*</span>_mp_d;		<span style="color:#8b949e;font-style:italic">/* Pointer to the limbs.  */</span>
</span></span><span style="display:flex;"><span>} __mpz_struct;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">typedef</span> <span style="color:#ff7b72">unsigned</span> <span style="color:#ff7b72">long</span> <span style="color:#ff7b72">mp_limb_t</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>所以可以知道参数结构体中只有三个值，两个int类型，以及一个指针指向存储的内存。</p>
<p>在ida中定义结构体，然后修改三个参数的类型</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a5d6ff">00000000</span> <span style="color:#ff7b72">mpz_t</span> struc ; (<span style="color:#ff7b72">sizeof</span><span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">0x10</span>, mappedto_8) ; <span style="color:#79c0ff;font-weight:bold">XREF</span>: main<span style="color:#ff7b72;font-weight:bold">/</span>r
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">00000000</span>                                         ; main<span style="color:#ff7b72;font-weight:bold">/</span>r ...
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">00000000</span> _mp_alloc dd <span style="color:#ff7b72;font-weight:bold">?</span>
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">00000004</span> _mp_size dd <span style="color:#ff7b72;font-weight:bold">?</span>
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">0000000</span><span style="color:#a5d6ff">8</span> _mp_d dq <span style="color:#ff7b72;font-weight:bold">?</span>
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">00000010</span> <span style="color:#ff7b72">mpz_t</span> ends
</span></span><span style="display:flex;"><span><span style="color:#a5d6ff">00000010</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic">/// 修改类型
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff7b72">mpz_t</span> v12; <span style="color:#8b949e;font-style:italic">// [rsp+50h] [rbp-40h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">mpz_t</span> v13; <span style="color:#8b949e;font-style:italic">// [rsp+60h] [rbp-30h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#8b949e;font-style:italic"></span>  <span style="color:#ff7b72">mpz_t</span> v14; <span style="color:#8b949e;font-style:italic">// [rsp+70h] [rbp-20h] BYREF
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>再动调获取每次调用<code>gmpz_powm</code>的参数值，每次修改一下对比后的跳转，就可以继续调试获取值。获取的值如下</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>powm_argu <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xD3</span>, <span style="color:#a5d6ff">0xF0</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xFF</span>, <span style="color:#a5d6ff">0x0D</span>, <span style="color:#a5d6ff">0x3A</span>, <span style="color:#a5d6ff">0xF2</span>, <span style="color:#a5d6ff">0x50</span>, <span style="color:#a5d6ff">0x23</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x5F</span>, <span style="color:#a5d6ff">0x08</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x33</span>, <span style="color:#a5d6ff">0x4D</span>, <span style="color:#a5d6ff">0x9D</span>, <span style="color:#a5d6ff">0x8E</span>, <span style="color:#a5d6ff">0xD1</span>, <span style="color:#a5d6ff">0x32</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x63</span>, <span style="color:#a5d6ff">0x8E</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x1B</span>, <span style="color:#a5d6ff">0x1F</span>, <span style="color:#a5d6ff">0xD7</span>, <span style="color:#a5d6ff">0x6C</span>, <span style="color:#a5d6ff">0x86</span>, <span style="color:#a5d6ff">0x03</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x49</span>, <span style="color:#a5d6ff">0x82</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x8F</span>, <span style="color:#a5d6ff">0xFC</span>, <span style="color:#a5d6ff">0xE3</span>, <span style="color:#a5d6ff">0x9B</span>, <span style="color:#a5d6ff">0xAE</span>, <span style="color:#a5d6ff">0x10</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xA1</span>, <span style="color:#a5d6ff">0xC6</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x7D</span>, <span style="color:#a5d6ff">0xF6</span>, <span style="color:#a5d6ff">0xEF</span>, <span style="color:#a5d6ff">0x42</span>, <span style="color:#a5d6ff">0xD9</span>, <span style="color:#a5d6ff">0x09</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x6D</span>, <span style="color:#a5d6ff">0x0C</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xB1</span>, <span style="color:#a5d6ff">0x8B</span>, <span style="color:#a5d6ff">0xAA</span>, <span style="color:#a5d6ff">0xE3</span>, <span style="color:#a5d6ff">0xE2</span>, <span style="color:#a5d6ff">0x1D</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xF5</span>, <span style="color:#a5d6ff">0xAE</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xF3</span>, <span style="color:#a5d6ff">0x41</span>, <span style="color:#a5d6ff">0x58</span>, <span style="color:#a5d6ff">0xC6</span>, <span style="color:#a5d6ff">0x3F</span>, <span style="color:#a5d6ff">0x10</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xDF</span>, <span style="color:#a5d6ff">0xD5</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xC9</span>, <span style="color:#a5d6ff">0xED</span>, <span style="color:#a5d6ff">0x70</span>, <span style="color:#a5d6ff">0x09</span>, <span style="color:#a5d6ff">0x1A</span>, <span style="color:#a5d6ff">0x01</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x8D</span>, <span style="color:#a5d6ff">0xE6</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0x39</span>, <span style="color:#a5d6ff">0xDF</span>, <span style="color:#a5d6ff">0xBD</span>, <span style="color:#a5d6ff">0x20</span>, <span style="color:#a5d6ff">0x8D</span>, <span style="color:#a5d6ff">0x5F</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xFB</span>, <span style="color:#a5d6ff">0xF3</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span><span style="color:#ff7b72;font-weight:bold">:</span> [<span style="color:#a5d6ff">0xED</span>, <span style="color:#a5d6ff">0xE0</span>, <span style="color:#a5d6ff">0x11</span>, <span style="color:#a5d6ff">0x4E</span>, <span style="color:#a5d6ff">0xB1</span>, <span style="color:#a5d6ff">0x45</span>]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></td></tr></table>
</div>
</div><p>这是总过10次加密，每次不同的powm中的指数与模数。</p>
<p>调用gmpz_powm的加密很像rsa，那可以尝试按照rsa的解密方法来解密。先分解<code>mod</code>，通过代码中可以知道每个mod是3个因子相乘，每个小于0x10000，直接一路爆破过去，可以得到三个因子，然后就是欧拉函数与求逆了。变成了baby rsa的密码题了</p>
<p>exp:</p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">73
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">Crypto.Util.number</span> <span style="color:#ff7b72">import</span> <span style="color:#ff7b72;font-weight:bold">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>powm_argu <span style="color:#ff7b72;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0xD3</span>, <span style="color:#a5d6ff">0xF0</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0xFF</span>, <span style="color:#a5d6ff">0x0D</span>, <span style="color:#a5d6ff">0x3A</span>, <span style="color:#a5d6ff">0xF2</span>, <span style="color:#a5d6ff">0x50</span>, <span style="color:#a5d6ff">0x23</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0x5F</span>, <span style="color:#a5d6ff">0x08</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0x33</span>, <span style="color:#a5d6ff">0x4D</span>, <span style="color:#a5d6ff">0x9D</span>, <span style="color:#a5d6ff">0x8E</span>, <span style="color:#a5d6ff">0xD1</span>, <span style="color:#a5d6ff">0x32</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0x63</span>, <span style="color:#a5d6ff">0x8E</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0x1B</span>, <span style="color:#a5d6ff">0x1F</span>, <span style="color:#a5d6ff">0xD7</span>, <span style="color:#a5d6ff">0x6C</span>, <span style="color:#a5d6ff">0x86</span>, <span style="color:#a5d6ff">0x03</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0x49</span>, <span style="color:#a5d6ff">0x82</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0x8F</span>, <span style="color:#a5d6ff">0xFC</span>, <span style="color:#a5d6ff">0xE3</span>, <span style="color:#a5d6ff">0x9B</span>, <span style="color:#a5d6ff">0xAE</span>, <span style="color:#a5d6ff">0x10</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0xA1</span>, <span style="color:#a5d6ff">0xC6</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0x7D</span>, <span style="color:#a5d6ff">0xF6</span>, <span style="color:#a5d6ff">0xEF</span>, <span style="color:#a5d6ff">0x42</span>, <span style="color:#a5d6ff">0xD9</span>, <span style="color:#a5d6ff">0x09</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0x6D</span>, <span style="color:#a5d6ff">0x0C</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0xB1</span>, <span style="color:#a5d6ff">0x8B</span>, <span style="color:#a5d6ff">0xAA</span>, <span style="color:#a5d6ff">0xE3</span>, <span style="color:#a5d6ff">0xE2</span>, <span style="color:#a5d6ff">0x1D</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0xF5</span>, <span style="color:#a5d6ff">0xAE</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0xF3</span>, <span style="color:#a5d6ff">0x41</span>, <span style="color:#a5d6ff">0x58</span>, <span style="color:#a5d6ff">0xC6</span>, <span style="color:#a5d6ff">0x3F</span>, <span style="color:#a5d6ff">0x10</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0xDF</span>, <span style="color:#a5d6ff">0xD5</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0xC9</span>, <span style="color:#a5d6ff">0xED</span>, <span style="color:#a5d6ff">0x70</span>, <span style="color:#a5d6ff">0x09</span>, <span style="color:#a5d6ff">0x1A</span>, <span style="color:#a5d6ff">0x01</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0x8D</span>, <span style="color:#a5d6ff">0xE6</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0x39</span>, <span style="color:#a5d6ff">0xDF</span>, <span style="color:#a5d6ff">0xBD</span>, <span style="color:#a5d6ff">0x20</span>, <span style="color:#a5d6ff">0x8D</span>, <span style="color:#a5d6ff">0x5F</span>]
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;exp&#34;</span>: [<span style="color:#a5d6ff">0xFB</span>, <span style="color:#a5d6ff">0xF3</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a5d6ff">&#34;mod&#34;</span>: [<span style="color:#a5d6ff">0xED</span>, <span style="color:#a5d6ff">0xE0</span>, <span style="color:#a5d6ff">0x11</span>, <span style="color:#a5d6ff">0x4E</span>, <span style="color:#a5d6ff">0xB1</span>, <span style="color:#a5d6ff">0x45</span>]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>encodes <span style="color:#ff7b72;font-weight:bold">=</span> [<span style="color:#a5d6ff">0x00000FE4C025C5F4</span>, <span style="color:#a5d6ff">0x00001B792FF17E8A</span>, <span style="color:#a5d6ff">0x00000183B156AB40</span>, <span style="color:#a5d6ff">0x00000BEFFCF5E5DA</span>, <span style="color:#a5d6ff">0x00000297CF86E251</span>, <span style="color:#a5d6ff">0x00000EB3EDC1D4B4</span>, <span style="color:#a5d6ff">0x000000FA10CE3A08</span>, <span style="color:#a5d6ff">0x0000002BDD418672</span>, <span style="color:#a5d6ff">0x00005EBB5050EA46</span>, <span style="color:#a5d6ff">0x000005BF9B73CF86</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">factor</span>(x: int) <span style="color:#ff7b72;font-weight:bold">-&gt;</span> list[int]:
</span></span><span style="display:flex;"><span>    r <span style="color:#ff7b72;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">for</span> j <span style="color:#ff7b72;font-weight:bold">in</span> range(<span style="color:#a5d6ff">2</span>, <span style="color:#a5d6ff">0x10000</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">if</span> x<span style="color:#ff7b72;font-weight:bold">%</span>j<span style="color:#ff7b72;font-weight:bold">==</span><span style="color:#a5d6ff">0</span>:
</span></span><span style="display:flex;"><span>            r<span style="color:#ff7b72;font-weight:bold">.</span>append(j)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> r
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">inv_x</span>(exp: int, r: list[int]) <span style="color:#ff7b72;font-weight:bold">-&gt;</span> int:
</span></span><span style="display:flex;"><span>    l <span style="color:#ff7b72;font-weight:bold">=</span> (r[<span style="color:#a5d6ff">0</span>]<span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1</span>) <span style="color:#ff7b72;font-weight:bold">*</span> (r[<span style="color:#a5d6ff">1</span>]<span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1</span>) <span style="color:#ff7b72;font-weight:bold">*</span> (r[<span style="color:#a5d6ff">2</span>]<span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> inverse(exp, l)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">dec</span>(c: int, x_inv: int, N: int):
</span></span><span style="display:flex;"><span>    m <span style="color:#ff7b72;font-weight:bold">=</span> pow(c, x_inv, N)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">return</span> m
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#79c0ff">b</span><span style="color:#a5d6ff">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">for</span> i,k <span style="color:#ff7b72;font-weight:bold">in</span> enumerate(powm_argu):
</span></span><span style="display:flex;"><span>    x <span style="color:#ff7b72;font-weight:bold">=</span> int<span style="color:#ff7b72;font-weight:bold">.</span>from_bytes(bytes(k[<span style="color:#a5d6ff">&#39;exp&#39;</span>]),<span style="color:#a5d6ff">&#39;little&#39;</span>)
</span></span><span style="display:flex;"><span>    N <span style="color:#ff7b72;font-weight:bold">=</span> int<span style="color:#ff7b72;font-weight:bold">.</span>from_bytes(bytes(k[<span style="color:#a5d6ff">&#39;mod&#39;</span>]),<span style="color:#a5d6ff">&#39;little&#39;</span>)
</span></span><span style="display:flex;"><span>    r <span style="color:#ff7b72;font-weight:bold">=</span> factor(N)
</span></span><span style="display:flex;"><span>    x_inv <span style="color:#ff7b72;font-weight:bold">=</span> inv_x(x, r)
</span></span><span style="display:flex;"><span>    m <span style="color:#ff7b72;font-weight:bold">=</span> dec(encodes[i], x_inv, N)
</span></span><span style="display:flex;"><span>    flag <span style="color:#ff7b72;font-weight:bold">+=</span> long_to_bytes(m)[::<span style="color:#ff7b72;font-weight:bold">-</span><span style="color:#a5d6ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(flag)    
</span></span></code></pre></td></tr></table>
</div>
</div><p>flag: <code>zer0pts{L00k_th3_1nt3rn4l_0f_l1br4r13s!}</code></p>
<div class="highlight"><div style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#64686c">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ./mimikyu zer0pts<span style="color:#ff7b72;font-weight:bold">{</span>L00k_th3_1nt3rn4l_0f_l1br4r13s!<span style="color:#ff7b72;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>Checking...........................................
</span></span><span style="display:flex;"><span>Correct!
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="参考">参考</h1>
<p>
<a href="https://www.cnblogs.com/xinwang-coding/p/12803237.html" target="_blank" rel="noopener">GMP-C/C++（大数库）使用方法 - 新望 - 博客园 (cnblogs.com)</a></p>
<p>
<a href="https://github.com/adamyaxley/Obfuscate" target="_blank" rel="noopener">adamyaxley/Obfuscate: Guaranteed compile-time string literal obfuscation header-only library for C++14 (github.com)</a></p>
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">Mi1itray.axe</span></span>
    
    <time>Jul 17, 2023</time>
    
      <span class="categories">
        Tags:
        
          <a class="category" href="https://military-axe.github.io/tags/reverse">reverse</a>  <a class="category" href="https://military-axe.github.io/tags/obfuscate">obfuscate</a>  <a class="category" href="https://military-axe.github.io/tags/rsa">rsa</a>  
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="https://military-axe.github.io/blog/2023-07-07-frida-call-java-class/method-to-explode/" title="Frida call java class/method to explode">Frida call java class/method to explode</a>
    

    
      <a class="basic-alignment right" href="https://military-axe.github.io/blog/2023-07-23-khaos-the-impact-of-inter-procedural-code-obfuscation-on-binary-diffing-techniques/" title="Khaos: The Impact of Inter-procedural Code Obfuscation on Binary Diffing Techniques">Khaos: The Impact of Inter-procedural Code Obfuscation on Binary Diffing Techniques</a>
    
  </p>
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    
      <h1>About</h1>
    

    <p>
      
        <p>mi1itray.axe&rsquo;s blog</p>
<p>This blog is mainly used to record my learning in the field of CTF. The main direction is Reverse.</p>
<p>You can use gpg to contact me, My public key in 
<a href="gpg_publickey.asc">here</a></p>

      
    </p>
  </section>

  
  



<ul class="sidebar-nav">
  <li class="sidebar-nav-item">
    <a target="_blank" rel="noopener noreferrer" href="https://github.com/Military-axe/" title="https://github.com/Military-axe/"><i class="fa fa-github fa-3x"></i></a>
    
    
    
    
    
    
    
    
    
    
    
    <a target="_blank" rel="noopener noreferrer" href="mailto:mi1itray.axe@gmail.com" title="mailto:mi1itray.axe@gmail.com"><i class="fa fa-envelope fa-3x"></i></a>

  
  
  </li>
</ul>

  

  
    
      <section class="odd">
        
          <h1>Friend link</h1>
        
        
          <li>
            <a href="https://h0pe-ay.github.io/" title="h0pe" >h0pe</a>
          </li>
        
          <li>
            <a href="http://locksec.top" title="l0ck" >l0ck</a>
          </li>
        
          <li>
            <a href="https://www.cnblogs.com/Ar3sh1/" title="Ar3sh1" >Ar3sh1</a>
          </li>
        
          <li>
            <a href="https://WyHlj.github.io/" title="fl3cha2o" >fl3cha2o</a>
          </li>
        
          <li>
            <a href="https://southsea.st/" title="southsea" >southsea</a>
          </li>
        
      </section>
    
  

  
  
  
    
      <section class="even">
        <h1>Recent Posts</h1>
        <ul id="recent_posts">
          
          
            
              <li class="post">
                <a href="/blog/2023-09-27-2023-%E7%A0%94%E7%A9%B6%E7%94%9F%E5%9B%BD%E8%B5%9B-reverse/">2023 研究生国赛 Reverse</a>
              </li>
            
          
            
          
            
              <li class="post">
                <a href="/blog/2023-09-06-2023-%E7%BE%8A%E5%9F%8E%E6%9D%AF-reverse/">2023 羊城杯 Reverse</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-09-01-rtag-cli-tools-dev/">Rtag cli tools dev</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-08-19-binary-diffing-1/">Binary Diffing 1</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-07-23-khaos-the-impact-of-inter-procedural-code-obfuscation-on-binary-diffing-techniques/">Khaos: The Impact of Inter-procedural Code Obfuscation on Binary Diffing Techniques</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-07-17-obfuscate-hide-string-zer0pts/">Obfuscate hide string &amp;&amp; zer0pts</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-07-07-frida-call-java-class/method-to-explode/">Frida call java class/method to explode</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-07-03-ida-symbolic-recovery/">Ida Symbolic Recovery</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-07-03-frida-learn-sctf-2023-checkflow/">Frida learn &amp;&amp; sctf 2023 checkFlow</a>
              </li>
            
          
        </ul>
      </section>
    
  
</aside>

  </div>
</div>

    <footer role="contentinfo">
      <p>Copyright &copy; 2023 Mi1itray.axe - <a href="https://military-axe.github.io/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io" rel="noopener noreferrer">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/" rel="noopener noreferrer">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    



    
    
    

    
  </body>
</html>

