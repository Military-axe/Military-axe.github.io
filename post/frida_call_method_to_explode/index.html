<!DOCTYPE html>
<html lang="en"><head>
<title>Frida call java class/method to explode</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="G-XXXXXXXXXX">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5, user-scalable=5" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:url" content="https://military-axe.github.io/post/frida_call_method_to_explode/">
  <meta property="og:site_name" content="Mi1itray.axe">
  <meta property="og:title" content="Frida call java class/method to explode">
  <meta property="og:description" content="利用Frida去调用java代码中的类，然后爆破。算是一种主动的方法。主要是之前有一道apk题目是爆破的思路，但是我不会写java代码，想起来很难受，冲浪的时候看到Sakura的blog有感，就再去试试，并记录在此。然后发现这题原来是adword原题，（其实题目挺简单，只是当时摆），气死✌了。
主要是记录Frida主动调用apk中Java中的代码。主动调用可以用于爆破，模拟程序部分执行。
需要注意的知识点是在java代码中的static类型数据在爆破过程中需要每次都对这种类型值重新设置。因为static类型在所有实例中都是统一，修改一个实例就会修改所有实例，需要用变量.属性.value = ...的写法重新设置值。
var bvar = b.$new(IntClass.$new(2)); for (...) { bvar._static_val.value = ...; }">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2023-07-07T10:01:10+08:00">
    <meta property="article:modified_time" content="2023-07-07T10:01:10+08:00">
    <meta property="article:tag" content="Frida">
    <meta property="article:tag" content="Android">
    <meta property="article:tag" content="Reverse">






  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Frida call java class/method to explode">
  <meta name="twitter:description" content="利用Frida去调用java代码中的类，然后爆破。算是一种主动的方法。主要是之前有一道apk题目是爆破的思路，但是我不会写java代码，想起来很难受，冲浪的时候看到Sakura的blog有感，就再去试试，并记录在此。然后发现这题原来是adword原题，（其实题目挺简单，只是当时摆），气死✌了。
主要是记录Frida主动调用apk中Java中的代码。主动调用可以用于爆破，模拟程序部分执行。
需要注意的知识点是在java代码中的static类型数据在爆破过程中需要每次都对这种类型值重新设置。因为static类型在所有实例中都是统一，修改一个实例就会修改所有实例，需要用变量.属性.value = ...的写法重新设置值。
var bvar = b.$new(IntClass.$new(2)); for (...) { bvar._static_val.value = ...; }">







      <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-XXXXXXXXXX');
        }
      </script>




<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "abcdefghzd");
</script>



  






      <script src="/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/scss/dark-mode.min.cb53f1bee2b8900cb4f082afbf00175d6618f281cf9a2fe8619e3b52d20b5721.css" integrity="sha256-y1PxvuK4kAy08IKvvwAXXWYY8oHPmi/oYZ47UtILVyE=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">



















</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/posts">
                    Archive
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    Categories
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    Tags
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/index.xml">
                    RSS Feed
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%83%8c%e6%99%af%e7%9f%a5%e8%af%86" class="nav-背景知识">
									背景知识
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#frida%e6%8d%95%e8%8e%b7%e5%bc%82%e5%b8%b8" class="nav-frida捕获异常">
									frida捕获异常
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java%e7%b1%bb%e4%b8%ad%e9%9d%99%e6%80%81%e5%80%bc%e5%9c%a8%e7%88%86%e7%a0%b4%e4%b8%ad%e9%9c%80%e8%a6%81%e4%bf%ae%e6%94%b9" class="nav-java类中静态值在爆破中需要修改">
									java类中静态值在爆破中需要修改
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#frida%e8%b0%83%e7%94%a8java%e4%b8%ad%e9%9d%99%e6%80%81%e6%96%b9%e6%b3%95%e4%b8%8e%e5%8a%a8%e6%80%81%e6%96%b9%e6%b3%95" class="nav-frida调用java中静态方法与动态方法">
									frida调用java中静态方法与动态方法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#easy-qahe17" class="nav-easy-qahe17">
									Easy-QAHE17
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#easyjava" class="nav-easyjava">
									EasyJava
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%82%e8%80%83" class="nav-参考">
									参考
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://military-axe.github.io/">
            Mi1itray.axe
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://military-axe.github.io/">
        <div class="single-column-header-title">Mi1itray.axe</div>
        
        <div class="single-column-header-subtitle">mi1itray.axe@gmail.com</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    Frida call java class/method to explode
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2023-07-07 10:01
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/reverse">Reverse</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/frida">frida</a>
                                &nbsp;
                            
                                <a href="/tags/android">android</a>
                                &nbsp;
                            
                                <a href="/tags/reverse">reverse</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>利用Frida去调用java代码中的类，然后爆破。算是一种主动的方法。主要是之前有一道apk题目是爆破的思路，但是我不会写java代码，想起来很难受，冲浪的时候看到<a href="https://eternalsakura13.com/">Sakura</a>的blog有感，就再去试试，并记录在此。然后发现这题原来是adword原题，（其实题目挺简单，只是当时摆），气死✌了。</p>
<p>主要是记录Frida主动调用apk中Java中的代码。主动调用可以用于爆破，模拟程序部分执行。</p>
<p>需要注意的知识点是在java代码中的static类型数据在爆破过程中需要每次都对这种类型值重新设置。因为static类型在所有实例中都是统一，修改一个实例就会修改所有实例，需要用<code>变量.属性.value = ...</code>的写法重新设置值。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">var</span> bvar = b.$new(IntClass.$new(<span style="color:#b452cd">2</span>));
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">for</span> (...) {
</span></span><span style="display:flex;"><span>    bvar._static_val.value = ...;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="背景知识">背景知识</h1>
<h2 id="frida捕获异常">frida捕获异常</h2>
<p>有的时候frida卡住，或者直接终止，没有异常显示，需要去捕获异常，调试脚本真的很有用！！其实就是调用js的异常捕获</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// 逻辑
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>} <span style="color:#8b008b;font-weight:bold">catch</span>(e) {
</span></span><span style="display:flex;"><span>    console.log(e);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="java类中静态值在爆破中需要修改">java类中静态值在爆破中需要修改</h2>
<p>在java类中，一个属性如果是<code>static</code>的，不是说这个值不能改，而是说这个属性在程序中是唯一的，无论几个实例，只要改了其中一个实例中static的值，其他实例对应的值也会被改变。</p>
<p>在爆破过程中，如果需要爆破过程中不停new一个新的类实例，记得看看其中有没有static类型的变量。比如下面的这个例子</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">b</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span>ArrayList&lt;Integer&gt;<span style="color:#bbb"> </span>a<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">new</span><span style="color:#bbb"> </span>ArrayList&lt;&gt;();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span>String<span style="color:#bbb"> </span>b<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#cd5555">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span>Integer<span style="color:#bbb"> </span>d<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>0;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Integer[]<span style="color:#bbb"> </span>c<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>{8,<span style="color:#bbb"> </span>25,<span style="color:#bbb"> </span>17,<span style="color:#bbb"> </span>23,<span style="color:#bbb"> </span>7,<span style="color:#bbb"> </span>22,<span style="color:#bbb"> </span>1,<span style="color:#bbb"> </span>16,<span style="color:#bbb"> </span>6,<span style="color:#bbb"> </span>9,<span style="color:#bbb"> </span>21,<span style="color:#bbb"> </span>0,<span style="color:#bbb"> </span>15,<span style="color:#bbb"> </span>5,<span style="color:#bbb"> </span>10,<span style="color:#bbb"> </span>18,<span style="color:#bbb"> </span>2,<span style="color:#bbb"> </span>24,<span style="color:#bbb"> </span>4,<span style="color:#bbb"> </span>11,<span style="color:#bbb"> </span>3,<span style="color:#bbb"> </span>14,<span style="color:#bbb"> </span>19,<span style="color:#bbb"> </span>12,<span style="color:#bbb"> </span>20,<span style="color:#bbb"> </span>13};<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#008b45">b</span>(Integer<span style="color:#bbb"> </span>num)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>intValue<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>num.<span style="color:#658b00">intValue</span>();<span style="color:#bbb"> </span>intValue<span style="color:#bbb"> </span>&lt;<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">c</span>.<span style="color:#658b00">length</span>;<span style="color:#bbb"> </span>intValue++)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>a.<span style="color:#658b00">add</span>(<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">c</span>[intValue]);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>&lt;<span style="color:#bbb"> </span>num.<span style="color:#658b00">intValue</span>();<span style="color:#bbb"> </span>i++)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>a.<span style="color:#658b00">add</span>(<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">c</span>[i]);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>...<span style="color:#bbb">
</span></span></span></code></pre></div><p>每次new一个b类，比如<code>b bVar = new b(2)</code>.如果要不停调用这个类，并且使用其中的方法，要注意其中的<code>static</code>变量会不会变。如果会变，那么在爆破过程中，需要new完实例后，修改static变量的值。</p>
<h2 id="frida调用java中静态方法与动态方法">frida调用java中静态方法与动态方法</h2>
<p>如果调用静态方法，可以直接调用，比如java代码如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Verifier</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">private</span><span style="color:#bbb"> </span><span style="color:#008b45">Verifier</span>()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">boolean</span><span style="color:#bbb"> </span><span style="color:#008b45">verifyPassword</span>(Context<span style="color:#bbb"> </span>context,<span style="color:#bbb"> </span>String<span style="color:#bbb"> </span>input)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    	</span>...<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span></code></pre></div><p>那么如果调用verifyPassword可以直接在frida中调用</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span> <span style="color:#8b008b;font-weight:bold">var</span> verify = Java.use(<span style="color:#cd5555">&#34;org.teamsik.ahe17.qualification.Verifier&#34;</span>);
</span></span><span style="display:flex;"><span>verify.verifyPassword(a, b);
</span></span></code></pre></div><p>如果是动态方法，有两种方法可以调用动态方法</p>
<p>第一种是，使用内存中已存在实例的方法，需要用到<code>java.choose(...)</code>，这个是在内存中寻找对象</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#228b22">//从内存中（堆）直接搜索已存在的对象
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>Java.choose(<span style="color:#cd5555">&#39;xxx.xxx.xxx&#39;</span>, <span style="color:#228b22">//这里写类名 
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>{	<span style="color:#228b22">//onMatch 匹配到对象执行的回调函数
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>	onMatch: <span style="color:#8b008b;font-weight:bold">function</span> (instance) {
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//堆中搜索完成后执行的回调函数
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    onComplete: <span style="color:#8b008b;font-weight:bold">function</span> () {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>第二种是，我们new一个新的实例，然后调用实例中的方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span> <span style="color:#228b22">//获取类的引用
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">var</span> cls = Java.use(<span style="color:#cd5555">&#39;这里写类名&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">//调用构造函数 创建新对象  这里注意参数
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">var</span> obj = cls.$new();
</span></span></code></pre></div><h1 id="easy-qahe17">Easy-QAHE17</h1>
<p>题目地址：<a href="https://github.com/Military-axe/ctf/tree/master/2023/Easy-QAHE17">ctf/2023/Easy-QAHE17 at master · Military-axe/ctf · GitHub</a></p>
<p>首先是看Sakura中提到的题目，也就是吾爱破解的一道题目。核心代码如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#008b45">verifyPasswordClick</span>(View<span style="color:#bbb"> </span>view)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>String<span style="color:#bbb"> </span>password<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">txPassword</span>.<span style="color:#658b00">getText</span>().<span style="color:#658b00">toString</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">if</span><span style="color:#bbb"> </span>(!Verifier.<span style="color:#658b00">verifyPassword</span>(<span style="color:#8b008b;font-weight:bold">this</span>,<span style="color:#bbb"> </span>password))<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>Toast.<span style="color:#658b00">makeText</span>(<span style="color:#8b008b;font-weight:bold">this</span>,<span style="color:#bbb"> </span>(<span style="color:#00688b;font-weight:bold">int</span>)<span style="color:#bbb"> </span>org.<span style="color:#658b00">teamsik</span>.<span style="color:#658b00">ahe17</span>.<span style="color:#658b00">qualification</span>.<span style="color:#658b00">easy</span>.<span style="color:#658b00">R</span>.<span style="color:#658b00">string</span>.<span style="color:#658b00">dialog_failure</span>,<span style="color:#bbb"> </span>1).<span style="color:#658b00">show</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">else</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>showSuccessDialog();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Verifier</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">private</span><span style="color:#bbb"> </span><span style="color:#008b45">Verifier</span>()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">boolean</span><span style="color:#bbb"> </span><span style="color:#008b45">verifyPassword</span>(Context<span style="color:#bbb"> </span>context,<span style="color:#bbb"> </span>String<span style="color:#bbb"> </span>input)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">if</span><span style="color:#bbb"> </span>(input.<span style="color:#658b00">length</span>()<span style="color:#bbb"> </span>!=<span style="color:#bbb"> </span>4)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#8b008b;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">false</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#00688b;font-weight:bold">byte</span>[]<span style="color:#bbb"> </span>v<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>encodePassword(input);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#00688b;font-weight:bold">byte</span>[]<span style="color:#bbb"> </span>p<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#cd5555">&#34;09042ec2c2c08c4cbece042681caf1d13984f24a&#34;</span>.<span style="color:#658b00">getBytes</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">if</span><span style="color:#bbb"> </span>(v.<span style="color:#658b00">length</span><span style="color:#bbb"> </span>==<span style="color:#bbb"> </span>p.<span style="color:#658b00">length</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#8b008b;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>&lt;<span style="color:#bbb"> </span>v.<span style="color:#658b00">length</span>;<span style="color:#bbb"> </span>i++)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                </span><span style="color:#8b008b;font-weight:bold">if</span><span style="color:#bbb"> </span>(v[i]<span style="color:#bbb"> </span>!=<span style="color:#bbb"> </span>p[i])<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                    </span><span style="color:#8b008b;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">false</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#8b008b;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">true</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">false</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>...<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>...<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>...<span style="color:#bbb">
</span></span></span></code></pre></div><p>输入长度为4，通过分析后面知道输入是数字。所以范围是1000-9999.所以是可以爆破的，但是爆破是要用到<code>encodePassword</code>方法，自己写一个当然也可以，但是很麻烦，关键是我不会写java代码。这里就可以直接frida调用<code>encodePassword</code>函数.</p>
<blockquote>
<p>注意这里encodePassword是静态方法，所以可以直接调用</p></blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">function</span> main() {
</span></span><span style="display:flex;"><span>    Java.perform(<span style="color:#8b008b;font-weight:bold">function</span> x() {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#cd5555">&#34;In Java perform&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> verify = Java.use(<span style="color:#cd5555">&#34;org.teamsik.ahe17.qualification.Verifier&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> stringClass = Java.use(<span style="color:#cd5555">&#34;java.lang.String&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> p = stringClass.$new(<span style="color:#cd5555">&#34;09042ec2c2c08c4cbece042681caf1d13984f24a&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">for</span> (<span style="color:#8b008b;font-weight:bold">var</span> i = <span style="color:#b452cd">999</span>; i &lt; <span style="color:#b452cd">10000</span>; i++){
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">var</span> v = stringClass.$new(<span style="color:#658b00">String</span>(i))
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">var</span> vSign = verify.encodePassword(v)
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">if</span> (<span style="color:#658b00">parseInt</span>(p) == <span style="color:#658b00">parseInt</span>(stringClass.$new(vSign))) {
</span></span><span style="display:flex;"><span>                console.log(<span style="color:#cd5555">&#34;yes: &#34;</span> + v)
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            console.log(<span style="color:#cd5555">&#34;not :&#34;</span> + v)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>setImmediate(main)
</span></span></code></pre></div><p>结果</p>
<pre tabindex="0"><code>not :9078
not :9079
not :9080
not :9081
not :9082
yes: 9083
</code></pre><p>需要注意的是，要调用<code>parseInt</code>解析内存中的内存再对比，因为string类型是java的string类型，对js代码来说是一段内存。</p>
<h1 id="easyjava">EasyJava</h1>
<p>题目地址：<a href="https://github.com/Military-axe/ctf/tree/master/2023/easyjava">ctf/2023/easyjava at master · Military-axe/ctf · GitHub</a></p>
<p>这题的正常解法可以查到：<a href="https://www.cnblogs.com/cainiao-chuanqi/p/13565030.html">攻防世界新手练习题_MOBILE(移动)</a></p>
<p>这题是纯java题，逻辑很清晰，对输入的每一个字符单个检查，加密并对比。所以可以很简单的想到爆破的思路</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span>Boolean<span style="color:#bbb"> </span><span style="color:#008b45">b</span>(String<span style="color:#bbb"> </span>str)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">if</span><span style="color:#bbb"> </span>(str.<span style="color:#658b00">startsWith</span>(<span style="color:#cd5555">&#34;flag{&#34;</span>)<span style="color:#bbb"> </span>&amp;&amp;<span style="color:#bbb"> </span>str.<span style="color:#658b00">endsWith</span>(<span style="color:#cd5555">&#34;}&#34;</span>))<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>String<span style="color:#bbb"> </span>substring<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>str.<span style="color:#658b00">substring</span>(5,<span style="color:#bbb"> </span>str.<span style="color:#658b00">length</span>()<span style="color:#bbb"> </span>-<span style="color:#bbb"> </span>1);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>b<span style="color:#bbb"> </span>bVar<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">new</span><span style="color:#bbb"> </span>b(2);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>a<span style="color:#bbb"> </span>aVar<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">new</span><span style="color:#bbb"> </span>a(3);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>StringBuilder<span style="color:#bbb"> </span>sb<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">new</span><span style="color:#bbb"> </span>StringBuilder();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>0;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>i2<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>i2<span style="color:#bbb"> </span>&lt;<span style="color:#bbb"> </span>substring.<span style="color:#658b00">length</span>();<span style="color:#bbb"> </span>i2++)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>sb.<span style="color:#658b00">append</span>(a(substring.<span style="color:#658b00">charAt</span>(i2)<span style="color:#bbb"> </span>+<span style="color:#bbb"> </span><span style="color:#cd5555">&#34;&#34;</span>,<span style="color:#bbb"> </span>bVar,<span style="color:#bbb"> </span>aVar));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>Integer<span style="color:#bbb"> </span>valueOf<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>Integer.<span style="color:#658b00">valueOf</span>(bVar.<span style="color:#658b00">b</span>().<span style="color:#658b00">intValue</span>()<span style="color:#bbb"> </span>/<span style="color:#bbb"> </span>25);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#8b008b;font-weight:bold">if</span><span style="color:#bbb"> </span>(valueOf.<span style="color:#658b00">intValue</span>()<span style="color:#bbb"> </span>&gt;<span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>&amp;&amp;<span style="color:#bbb"> </span>valueOf.<span style="color:#658b00">intValue</span>()<span style="color:#bbb"> </span>&gt;=<span style="color:#bbb"> </span>1)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                </span>i++;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">return</span><span style="color:#bbb"> </span>Boolean.<span style="color:#658b00">valueOf</span>(sb.<span style="color:#658b00">toString</span>().<span style="color:#658b00">equals</span>(<span style="color:#cd5555">&#34;wigwrkaugala&#34;</span>));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">false</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span></code></pre></div><p>所以可以单个字符爆破，但是要注意到，<code>com.a.easyjava.b</code>和<code>com.a.easyjava.a</code>两个类中都存在static属性的变量，下面是b类的</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">b</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span>ArrayList&lt;Integer&gt;<span style="color:#bbb"> </span>a<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">new</span><span style="color:#bbb"> </span>ArrayList&lt;&gt;();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span>String<span style="color:#bbb"> </span>b<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#cd5555">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span>Integer<span style="color:#bbb"> </span>d<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>0;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Integer[]<span style="color:#bbb"> </span>c<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>{8,<span style="color:#bbb"> </span>25,<span style="color:#bbb"> </span>17,<span style="color:#bbb"> </span>23,<span style="color:#bbb"> </span>7,<span style="color:#bbb"> </span>22,<span style="color:#bbb"> </span>1,<span style="color:#bbb"> </span>16,<span style="color:#bbb"> </span>6,<span style="color:#bbb"> </span>9,<span style="color:#bbb"> </span>21,<span style="color:#bbb"> </span>0,<span style="color:#bbb"> </span>15,<span style="color:#bbb"> </span>5,<span style="color:#bbb"> </span>10,<span style="color:#bbb"> </span>18,<span style="color:#bbb"> </span>2,<span style="color:#bbb"> </span>24,<span style="color:#bbb"> </span>4,<span style="color:#bbb"> </span>11,<span style="color:#bbb"> </span>3,<span style="color:#bbb"> </span>14,<span style="color:#bbb"> </span>19,<span style="color:#bbb"> </span>12,<span style="color:#bbb"> </span>20,<span style="color:#bbb"> </span>13};<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#008b45">b</span>(Integer<span style="color:#bbb"> </span>num)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>intValue<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>num.<span style="color:#658b00">intValue</span>();<span style="color:#bbb"> </span>intValue<span style="color:#bbb"> </span>&lt;<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">c</span>.<span style="color:#658b00">length</span>;<span style="color:#bbb"> </span>intValue++)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>a.<span style="color:#658b00">add</span>(<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">c</span>[intValue]);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>&lt;<span style="color:#bbb"> </span>num.<span style="color:#658b00">intValue</span>();<span style="color:#bbb"> </span>i++)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>a.<span style="color:#658b00">add</span>(<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">c</span>[i]);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">static</span><span style="color:#bbb"> </span><span style="color:#00688b;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#008b45">a</span>()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>intValue<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>a.<span style="color:#658b00">get</span>(0).<span style="color:#658b00">intValue</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>a.<span style="color:#658b00">remove</span>(0);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>a.<span style="color:#658b00">add</span>(Integer.<span style="color:#658b00">valueOf</span>(intValue));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>b<span style="color:#bbb"> </span>+=<span style="color:#bbb"> </span><span style="color:#cd5555">&#34;&#34;</span><span style="color:#bbb"> </span>+<span style="color:#bbb"> </span>b.<span style="color:#658b00">charAt</span>(0);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>b<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>b.<span style="color:#658b00">substring</span>(1,<span style="color:#bbb"> </span>27);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>Integer<span style="color:#bbb"> </span>num<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>d;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>d<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>Integer.<span style="color:#658b00">valueOf</span>(d.<span style="color:#658b00">intValue</span>()<span style="color:#bbb"> </span>+<span style="color:#bbb"> </span>1);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span>Integer<span style="color:#bbb"> </span><span style="color:#008b45">a</span>(String<span style="color:#bbb"> </span>str)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>0;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">if</span><span style="color:#bbb"> </span>(b.<span style="color:#658b00">contains</span>(str.<span style="color:#658b00">toLowerCase</span>()))<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>Integer<span style="color:#bbb"> </span>valueOf<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>Integer.<span style="color:#658b00">valueOf</span>(b.<span style="color:#658b00">indexOf</span>(str));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#8b008b;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#00688b;font-weight:bold">int</span><span style="color:#bbb"> </span>i2<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>i2<span style="color:#bbb"> </span>&lt;<span style="color:#bbb"> </span>a.<span style="color:#658b00">size</span>()<span style="color:#bbb"> </span>-<span style="color:#bbb"> </span>1;<span style="color:#bbb"> </span>i2++)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                </span><span style="color:#8b008b;font-weight:bold">if</span><span style="color:#bbb"> </span>(a.<span style="color:#658b00">get</span>(i2)<span style="color:#bbb"> </span>==<span style="color:#bbb"> </span>valueOf)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                    </span>i<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>Integer.<span style="color:#658b00">valueOf</span>(i2);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb"> </span><span style="color:#8b008b;font-weight:bold">else</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>i<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span>str.<span style="color:#658b00">contains</span>(<span style="color:#cd5555">&#34; &#34;</span>)<span style="color:#bbb"> </span>?<span style="color:#bbb"> </span>-10<span style="color:#bbb"> </span>:<span style="color:#bbb"> </span>-1;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>a();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">return</span><span style="color:#bbb"> </span>i;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#8b008b;font-weight:bold">public</span><span style="color:#bbb"> </span>Integer<span style="color:#bbb"> </span><span style="color:#008b45">b</span>()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#8b008b;font-weight:bold">return</span><span style="color:#bbb"> </span>d;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span></code></pre></div><p>b类中的a，b，d变量都是static类型的同时，这三个变量都会被下面的方法所改变。所以如果要爆破，需要重新修改实例中的属性值。如果不重新修改属性的值，我们通过观察b类中的b变量可以看到会有什么问题。</p>
<blockquote>
<p>这个脚本是爆破第一个字符在加密后所有的可能性。爆破范围通过分析b类可以缩小到<code>a-z</code>，然后模仿加密过程，加密一个字符看看结果。中间每循环一次会重新申请一个<code>b</code>和<code>a</code>类的实例，想通过申请新的实例来避免类中变量的修改.</p></blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">function</span> main() {
</span></span><span style="display:flex;"><span>    Java.perform(<span style="color:#8b008b;font-weight:bold">function</span> x() {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#cd5555">&#39;[+] script load&#39;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> b = Java.use(<span style="color:#cd5555">&#34;com.a.easyjava.b&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> a = Java.use(<span style="color:#cd5555">&#34;com.a.easyjava.a&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> StringClass = Java.use(<span style="color:#cd5555">&#34;java.lang.String&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> IntClass = Java.use(<span style="color:#cd5555">&#34;java.lang.Integer&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> MainActivity = Java.use(<span style="color:#cd5555">&#34;com.a.easyjava.MainActivity&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">try</span> { <span style="color:#228b22">// try catch 用来查看报错的，可以去掉
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>            <span style="color:#8b008b;font-weight:bold">for</span> (<span style="color:#8b008b;font-weight:bold">var</span> i = <span style="color:#b452cd">97</span>; i &lt; <span style="color:#b452cd">123</span>; i++) {
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">var</span> bvar = b.$new(IntClass.$new(<span style="color:#b452cd">2</span>));
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">var</span> avar = a.$new(IntClass.$new(<span style="color:#b452cd">3</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">var</span> s = <span style="color:#658b00">String</span>.fromCharCode(i);
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">var</span> c = MainActivity.a(s, bvar, avar);
</span></span><span style="display:flex;"><span>                console.log(<span style="color:#cd5555">`enc(</span><span style="color:#cd5555">${</span>s<span style="color:#cd5555">}</span><span style="color:#cd5555">) =&gt; </span><span style="color:#cd5555">${</span>c<span style="color:#cd5555">}</span><span style="color:#cd5555">, b.a =&gt; </span><span style="color:#cd5555">${</span>b._b.value<span style="color:#cd5555">}</span><span style="color:#cd5555">`</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#8b008b;font-weight:bold">catch</span> (e) {
</span></span><span style="display:flex;"><span>            console.log(e);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#cd5555">&#39;[+] script end&#39;</span>);
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>setImmediate(main)
</span></span></code></pre></div><p>结果如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#228b22"># python3 loader.py</span>
</span></span><span style="display:flex;"><span>[+] script load
</span></span><span style="display:flex;"><span>enc(a) =&gt; a, b.b =&gt; bcdefghijklmnopqrstuvwxyza
</span></span><span style="display:flex;"><span>enc(b) =&gt; a, b.b =&gt; cdefghijklmnopqrstuvwxyzab
</span></span><span style="display:flex;"><span>enc(c) =&gt; a, b.b =&gt; defghijklmnopqrstuvwxyzabc
</span></span><span style="display:flex;"><span>enc(d) =&gt; a, b.b =&gt; efghijklmnopqrstuvwxyzabcd
</span></span><span style="display:flex;"><span>enc(e) =&gt; a, b.b =&gt; fghijklmnopqrstuvwxyzabcde
</span></span><span style="display:flex;"><span>enc(f) =&gt; a, b.b =&gt; ghijklmnopqrstuvwxyzabcdef
</span></span><span style="display:flex;"><span>enc(g) =&gt; a, b.b =&gt; hijklmnopqrstuvwxyzabcdefg
</span></span><span style="display:flex;"><span>enc(h) =&gt; a, b.b =&gt; ijklmnopqrstuvwxyzabcdefgh
</span></span><span style="display:flex;"><span>enc(i) =&gt; a, b.b =&gt; jklmnopqrstuvwxyzabcdefghi
</span></span><span style="display:flex;"><span>enc(j) =&gt; a, b.b =&gt; klmnopqrstuvwxyzabcdefghij
</span></span><span style="display:flex;"><span>enc(k) =&gt; a, b.b =&gt; lmnopqrstuvwxyzabcdefghijk
</span></span><span style="display:flex;"><span>enc(l) =&gt; a, b.b =&gt; mnopqrstuvwxyzabcdefghijkl
</span></span><span style="display:flex;"><span>enc(m) =&gt; a, b.b =&gt; nopqrstuvwxyzabcdefghijklm
</span></span><span style="display:flex;"><span>enc(n) =&gt; a, b.b =&gt; opqrstuvwxyzabcdefghijklmn
</span></span><span style="display:flex;"><span>enc(o) =&gt; a, b.b =&gt; pqrstuvwxyzabcdefghijklmno
</span></span><span style="display:flex;"><span>enc(p) =&gt; a, b.b =&gt; qrstuvwxyzabcdefghijklmnop
</span></span><span style="display:flex;"><span>enc(q) =&gt; a, b.b =&gt; rstuvwxyzabcdefghijklmnopq
</span></span><span style="display:flex;"><span>enc(r) =&gt; a, b.b =&gt; stuvwxyzabcdefghijklmnopqr
</span></span><span style="display:flex;"><span>enc(s) =&gt; a, b.b =&gt; tuvwxyzabcdefghijklmnopqrs
</span></span><span style="display:flex;"><span>enc(t) =&gt; a, b.b =&gt; uvwxyzabcdefghijklmnopqrst
</span></span><span style="display:flex;"><span>enc(u) =&gt; a, b.b =&gt; vwxyzabcdefghijklmnopqrstu
</span></span><span style="display:flex;"><span>enc(v) =&gt; a, b.b =&gt; wxyzabcdefghijklmnopqrstuv
</span></span><span style="display:flex;"><span>enc(w) =&gt; a, b.b =&gt; xyzabcdefghijklmnopqrstuvw
</span></span><span style="display:flex;"><span>enc(x) =&gt; a, b.b =&gt; yzabcdefghijklmnopqrstuvwx
</span></span><span style="display:flex;"><span>enc(y) =&gt; a, b.b =&gt; zabcdefghijklmnopqrstuvwxy
</span></span><span style="display:flex;"><span>enc(z) =&gt; a, b.b =&gt; abcdefghijklmnopqrstuvwxyz
</span></span><span style="display:flex;"><span>[+] script end
</span></span></code></pre></div><p>可以看到实际上，虽然每次new了一个新的实例，但是实例中的static变量是变了的，这导致了之前的爆破会影响到下一次爆破，同时也可以看到加密结果全部都是<code>a</code>。所以如果要爆破，就得想办法让每次爆破，新的实例中的值不变。</p>
<p>需要使用<code>bvar._b.value = StringClass.$new(&quot;abcdefghijklmnopqrstuvwxyz&quot;);</code>这样的语法对static类型的变量重新设值。</p>
<blockquote>
<p>需要注意的是有些变量在jadx/jeb中看到的名字可能会被重载，需要加一个下划线比如b -&gt; _b。可以通过console打印看看是不是unknow，也可以直接用jadx右键复制frida片段，查看此变量frida需不需要加一个下划线</p></blockquote>
<p>解题脚本的思路就很简单，单个字符来爆破，每次重新生成类的实例，并将类中的值置为初始状态（通过调用类<code>$init</code>方法）。</p>
<p>exp</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">function</span> main() {
</span></span><span style="display:flex;"><span>    Java.perform(<span style="color:#8b008b;font-weight:bold">function</span> x() {
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#cd5555">&#39;[+] script load&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> b = Java.use(<span style="color:#cd5555">&#34;com.a.easyjava.b&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> a = Java.use(<span style="color:#cd5555">&#34;com.a.easyjava.a&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> IntClass = Java.use(<span style="color:#cd5555">&#34;java.lang.Integer&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> StringClass = Java.use(<span style="color:#cd5555">&#34;java.lang.String&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> ArrayList = Java.use(<span style="color:#cd5555">&#34;java.util.ArrayList&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> MainActivity = Java.use(<span style="color:#cd5555">&#34;com.a.easyjava.MainActivity&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> flag = <span style="color:#8b008b;font-weight:bold">new</span> <span style="color:#658b00">Array</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> cipher = <span style="color:#cd5555">&#34;wigwrkaugala&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> bvar = b.$new(IntClass.$new(<span style="color:#b452cd">2</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">var</span> avar = a.$new(IntClass.$new(<span style="color:#b452cd">3</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">for</span> (<span style="color:#8b008b;font-weight:bold">var</span> _ = <span style="color:#b452cd">0</span>; _ &lt; cipher.length; _++) {
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">for</span> (<span style="color:#8b008b;font-weight:bold">var</span> i = <span style="color:#b452cd">97</span>; i &lt; <span style="color:#b452cd">123</span>; i++) { <span style="color:#228b22">// 97 - 123是字母a-z
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>                <span style="color:#228b22">// reset static value
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>                bvar._b.value = StringClass.$new(<span style="color:#cd5555">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>);
</span></span><span style="display:flex;"><span>                bvar.d.value = IntClass.$new(<span style="color:#b452cd">0</span>);
</span></span><span style="display:flex;"><span>                bvar._a.value = ArrayList.$new();
</span></span><span style="display:flex;"><span>                bvar[<span style="color:#cd5555">&#34;$init&#34;</span>](IntClass.$new(<span style="color:#b452cd">2</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                avar.b.value = StringClass.$new(<span style="color:#cd5555">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>);
</span></span><span style="display:flex;"><span>                avar.d.value = IntClass.$new(<span style="color:#b452cd">0</span>);
</span></span><span style="display:flex;"><span>                avar._a.value = ArrayList.$new();
</span></span><span style="display:flex;"><span>                avar[<span style="color:#cd5555">&#34;$init&#34;</span>](IntClass.$new(<span style="color:#b452cd">3</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">var</span> s = <span style="color:#658b00">String</span>.fromCharCode(i);
</span></span><span style="display:flex;"><span>                flag.push(s);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">for</span> (<span style="color:#8b008b;font-weight:bold">var</span> e = <span style="color:#b452cd">0</span>; e &lt; flag.length; e++) {
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">var</span> c = MainActivity.a(flag[e].toString(), bvar, avar);
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">if</span> (c != cipher[e]) {
</span></span><span style="display:flex;"><span>                        <span style="color:#8b008b;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">if</span> (c == cipher[flag.length - <span style="color:#b452cd">1</span>]) {
</span></span><span style="display:flex;"><span>                    console.log(flag);
</span></span><span style="display:flex;"><span>                    <span style="color:#8b008b;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                flag.length -= <span style="color:#b452cd">1</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#cd5555">&#39;flag{&#39;</span> + flag.join(<span style="color:#cd5555">&#39;&#39;</span>) + <span style="color:#cd5555">&#39;}&#39;</span>);
</span></span><span style="display:flex;"><span>        console.log(<span style="color:#cd5555">&#39;[+] script end&#39;</span>);
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>setImmediate(main);
</span></span></code></pre></div><p>结果</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali ~/frida-script-dev# python3 loader.py
</span></span><span style="display:flex;"><span>[+] script load
</span></span><span style="display:flex;"><span>v
</span></span><span style="display:flex;"><span>v,e
</span></span><span style="display:flex;"><span>v,e,n
</span></span><span style="display:flex;"><span>v,e,n,i
</span></span><span style="display:flex;"><span>v,e,n,i,v
</span></span><span style="display:flex;"><span>v,e,n,i,v,i
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i,v
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i,v,i
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i,v,i,c
</span></span><span style="display:flex;"><span>v,e,n,i,v,i,a,i,v,i,c,i
</span></span><span style="display:flex;"><span>flag{veniviaivici}
</span></span><span style="display:flex;"><span>[+] script end
</span></span></code></pre></div><h1 id="参考">参考</h1>
<p><a href="https://eternalsakura13.com/2020/07/04/frida/">Frida Android hook | Sakuraのblog (eternalsakura13.com)</a></p>
<p><a href="https://bbs.kanxue.com/thread-257745.htm">52pojie2020春节红包-第三题（升级版）暴力破解</a></p>
<p><a href="http://www.manongjc.com/detail/23-ygwigcykklzbgnh.html">frida主动调用app方法 - 码农教程 (manongjc.com)</a></p>
<p><a href="https://blog.csdn.net/weixin_39915210/article/details/114208140#:~:text=Java">java static 区别_Java 静态与动态的区别_</a></p>
<p><a href="https://www.cnblogs.com/cainiao-chuanqi/p/13565030.html">攻防世界新手练习题_MOBILE(移动) - 菜鸟-传奇 - 博客园 (cnblogs.com)</a></p>
                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2023-07-07</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/post/obfuscate_hide_string_and_zer0pts/">
			Next<br>Obfuscate hide string &amp;&amp; zer0pts
                </a>
                
                
                
                <a class="older-posts" href="/post/ida_symbolic_recovery/">
			Previous<br>Ida Symbolic Recovery
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                












<script src="https://giscus.app/client.js"
        data-repo="username/repo"
        data-repo-id="**************************"
        data-category="General"
        data-category-id="*********************"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>

            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://military-axe.github.io/">
    
        <div class="nav-title">
            Mi1itray.axe
        </div>
        
        <div class="nav-subtitle">
            mi1itray.axe@gmail.com
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/posts">
                Archive
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                Categories
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                Tags
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/index.xml">
                RSS Feed
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	mi1itray.axe copyright.
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%83%8c%e6%99%af%e7%9f%a5%e8%af%86" class="nav-背景知识">
									背景知识
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#frida%e6%8d%95%e8%8e%b7%e5%bc%82%e5%b8%b8" class="nav-frida捕获异常">
									frida捕获异常
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#java%e7%b1%bb%e4%b8%ad%e9%9d%99%e6%80%81%e5%80%bc%e5%9c%a8%e7%88%86%e7%a0%b4%e4%b8%ad%e9%9c%80%e8%a6%81%e4%bf%ae%e6%94%b9" class="nav-java类中静态值在爆破中需要修改">
									java类中静态值在爆破中需要修改
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#frida%e8%b0%83%e7%94%a8java%e4%b8%ad%e9%9d%99%e6%80%81%e6%96%b9%e6%b3%95%e4%b8%8e%e5%8a%a8%e6%80%81%e6%96%b9%e6%b3%95" class="nav-frida调用java中静态方法与动态方法">
									frida调用java中静态方法与动态方法
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#easy-qahe17" class="nav-easy-qahe17">
									Easy-QAHE17
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#easyjava" class="nav-easyjava">
									EasyJava
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%8f%82%e8%80%83" class="nav-参考">
									参考
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>

<div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	mi1itray.axe copyright.
	
</div>
            </div>
    
    <script src="/js/journal.js"></script></body>
</html>
